<!DOCTYPE HTML>
<html lang="en" >
    <!-- Start book Onedata Documentation -->
<!-- Start book Onedata Documentation -->
    <head>
        <!-- head:start -->
<!-- head:start -->
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Oneprovider setup | Onedata Documentation</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-onedata-theme/nanoscroller.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-onedata-theme/onedata.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-onedata-theme/rest.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-image-captions/image-captions.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-toggle-chapters/toggle.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-responsive-iframes/plugin.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    
        <link rel="stylesheet" href="../../website-1686572662585.css">
    

        
    
    
    <link rel="next" href="../../doc/administering_onedata/creating_user_accounts.html" />
    
    
    <link rel="prev" href="../../doc/administering_onedata/onezone_tutorial.html" />
    

        <!-- head:end -->
<!-- head:end -->
    </head>
    <body>
        <!-- body:start -->
<!-- body:start -->
        
    <div class="book"
        data-level="3.6.1"
        data-chapter-title="Oneprovider setup"
        data-filepath="doc/administering_onedata/oneprovider_tutorial.md"
        data-basepath="../.."
        data-revision="Mon Jun 12 2023 12:24:21 GMT+0000 (UTC)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Onedata Documentation
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" >
            
            <span><b>1.</b> Getting Started</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="doc/getting_started/what_is_onedata.html">
            
                
                    <a href="../../doc/getting_started/what_is_onedata.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        What is Onedata?
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="doc/getting_started/downloading_onedata.html">
            
                
                    <a href="../../doc/getting_started/downloading_onedata.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Downloading Onedata
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="doc/getting_started/user_onedata_101.html">
            
                
                    <a href="../../doc/getting_started/user_onedata_101.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        User Quickstart
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="doc/getting_started/admin_onedata_101.html">
            
                
                    <a href="../../doc/getting_started/admin_onedata_101.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.4.</b>
                        
                        Admin Quickstart
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="doc/administering_onedata/onezone_quick_tutorial.html">
            
                
                    <a href="../../doc/administering_onedata/onezone_quick_tutorial.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.4.1.</b>
                        
                        Onezone deploy
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="doc/administering_onedata/oneprovider_quick_tutorial.html">
            
                
                    <a href="../../doc/administering_onedata/oneprovider_quick_tutorial.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.4.2.</b>
                        
                        Oneprovider deploy
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" >
            
            <span><b>2.</b> Onedata for users</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="doc/user_guide.html">
            
                
                    <a href="../../doc/user_guide.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Overview
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="doc/using_onedata/account_management.html">
            
                
                    <a href="../../doc/using_onedata/account_management.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Account Management
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="doc/using_onedata/space_management.html">
            
                
                    <a href="../../doc/using_onedata/space_management.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        Space Management
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="doc/using_onedata/space_collaboration.html">
            
                
                    <a href="../../doc/using_onedata/space_collaboration.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                        Space Collaboration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="doc/using_onedata/group_management.html">
            
                
                    <a href="../../doc/using_onedata/group_management.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.</b>
                        
                        Group Management
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="doc/using_onedata/privilege_management.html">
            
                
                    <a href="../../doc/using_onedata/privilege_management.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.6.</b>
                        
                        Privilege Management
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="doc/using_onedata/file_management.html">
            
                
                    <a href="../../doc/using_onedata/file_management.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.7.</b>
                        
                        File Management
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="doc/using_onedata/replication_management.html">
            
                
                    <a href="../../doc/using_onedata/replication_management.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.8.</b>
                        
                        Replication and Transfer Management
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.9" data-path="doc/using_onedata/metadata.html">
            
                
                    <a href="../../doc/using_onedata/metadata.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.9.</b>
                        
                        Metadata
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.10" data-path="doc/using_onedata/views.html">
            
                
                    <a href="../../doc/using_onedata/views.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.10.</b>
                        
                        Views
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.11" data-path="doc/using_onedata/tokens.html">
            
                
                    <a href="../../doc/using_onedata/tokens.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.11.</b>
                        
                        Tokens
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.12" data-path="doc/using_onedata/oneclient.html">
            
                
                    <a href="../../doc/using_onedata/oneclient.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.12.</b>
                        
                        Oneclient CLI
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.13" data-path="doc/using_onedata/docker_volume_plugin.html">
            
                
                    <a href="../../doc/using_onedata/docker_volume_plugin.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.13.</b>
                        
                        Docker volume plugin
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.14" data-path="doc/using_onedata/shares.html">
            
                
                    <a href="../../doc/using_onedata/shares.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.14.</b>
                        
                        Shares
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.15" data-path="doc/using_onedata/file_registration.html">
            
                
                    <a href="../../doc/using_onedata/file_registration.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.15.</b>
                        
                        File registration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.16" data-path="doc/using_onedata/handle_services.html">
            
                
                    <a href="../../doc/using_onedata/handle_services.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.16.</b>
                        
                        Handle Services
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.17" data-path="doc/using_onedata/using_onedata_from_cli.html">
            
                
                    <a href="../../doc/using_onedata/using_onedata_from_cli.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.17.</b>
                        
                        Using REST API
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.18" data-path="doc/using_onedata/onedatafs.html">
            
                
                    <a href="../../doc/using_onedata/onedatafs.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.18.</b>
                        
                        OnedataFS Python interface
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.19" data-path="doc/using_onedata/jupyter_integration.html">
            
                
                    <a href="../../doc/using_onedata/jupyter_integration.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.19.</b>
                        
                        Jupyter integration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.20" data-path="doc/using_onedata/qos.html">
            
                
                    <a href="../../doc/using_onedata/qos.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.20.</b>
                        
                        Quality of Service
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" >
            
            <span><b>3.</b> Onedata for administrators</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="doc/admin_guide.html">
            
                
                    <a href="../../doc/admin_guide.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Overview
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="doc/system_requirements.html">
            
                
                    <a href="../../doc/system_requirements.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        System requirements
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="doc/compatibility_reference.html">
            
                
                    <a href="../../doc/compatibility_reference.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        Compatibility reference
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="Services overview.html">
            
            <span><b>3.4.</b> Services overview</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.4.1" data-path="doc/administering_onedata/onezone_overview.html">
            
                
                    <a href="../../doc/administering_onedata/onezone_overview.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.1.</b>
                        
                        Onezone overview
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4.2" data-path="doc/administering_onedata/provider_overview.html">
            
                
                    <a href="../../doc/administering_onedata/provider_overview.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.2.</b>
                        
                        Oneprovider overview
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4.3" data-path="doc/administering_onedata/onepanel_overview.html">
            
                
                    <a href="../../doc/administering_onedata/onepanel_overview.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.3.</b>
                        
                        Onepanel overview
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="doc/administering_onedata/deployment_tutorial.html">
            
                
                    <a href="../../doc/administering_onedata/deployment_tutorial.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        Installation tutorial
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.5.1" data-path="doc/administering_onedata/onedatify_deploy.html">
            
                
                    <a href="../../doc/administering_onedata/onedatify_deploy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.1.</b>
                        
                        Oneprovider deploy
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5.2" data-path="doc/administering_onedata/onedatify_deploy_with_import.html">
            
                
                    <a href="../../doc/administering_onedata/onedatify_deploy_with_import.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.2.</b>
                        
                        Oneprovider deploy and expose data
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5.3" data-path="doc/administering_onedata/onezone_tutorial.html">
            
                
                    <a href="../../doc/administering_onedata/onezone_tutorial.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.3.</b>
                        
                        Onezone setup
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="Administrator manual.html">
            
            <span><b>3.6.</b> Administrator manual</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="3.6.1" data-path="doc/administering_onedata/oneprovider_tutorial.html">
            
                
                    <a href="../../doc/administering_onedata/oneprovider_tutorial.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.1.</b>
                        
                        Oneprovider setup
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.2" data-path="doc/administering_onedata/creating_user_accounts.html">
            
                
                    <a href="../../doc/administering_onedata/creating_user_accounts.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.2.</b>
                        
                        Creating User accounts
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.3" data-path="doc/administering_onedata/openid_saml_configuration.html">
            
                
                    <a href="../../doc/administering_onedata/openid_saml_configuration.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.3.</b>
                        
                        OpenID &amp; SAML Configuration
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.6.3.1" data-path="doc/administering_onedata/openid_saml_configuration/openid_configuration_legacy.html">
            
                
                    <a href="../../doc/administering_onedata/openid_saml_configuration/openid_configuration_legacy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.3.1.</b>
                        
                        18.02.0-rc11 or older
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.3.2" data-path="doc/administering_onedata/openid_saml_configuration/openid_saml_configuration_18_02.html">
            
                
                    <a href="../../doc/administering_onedata/openid_saml_configuration/openid_saml_configuration_18_02.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.3.2.</b>
                        
                        18.02.0-rc12 - 18.02.*
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.3.3" data-path="doc/administering_onedata/openid_saml_configuration/openid_saml_configuration_19_02.html">
            
                
                    <a href="../../doc/administering_onedata/openid_saml_configuration/openid_saml_configuration_19_02.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.3.3.</b>
                        
                        19.02.* or newer
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.3.4" data-path="doc/administering_onedata/openid_saml_configuration/google_idp_tutorial.html">
            
                
                    <a href="../../doc/administering_onedata/openid_saml_configuration/google_idp_tutorial.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.3.4.</b>
                        
                        Google IdP tutorial
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.6.4" data-path="doc/administering_onedata/provider_space_support.html">
            
                
                    <a href="../../doc/administering_onedata/provider_space_support.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.4.</b>
                        
                        Space Support
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.5" data-path="doc/administering_onedata/storage_configuration.html">
            
                
                    <a href="../../doc/administering_onedata/storage_configuration.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.5.</b>
                        
                        Storage Configuration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.6" data-path="doc/administering_onedata/storage_import.html">
            
                
                    <a href="../../doc/administering_onedata/storage_import.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.6.</b>
                        
                        Storage import
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.7" data-path="doc/administering_onedata/ceph_cluster_deployment.html">
            
                
                    <a href="../../doc/administering_onedata/ceph_cluster_deployment.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.7.</b>
                        
                        Ceph cluster deployment
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.8" data-path="doc/administering_onedata/ssl_certificate_management.html">
            
                
                    <a href="../../doc/administering_onedata/ssl_certificate_management.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.8.</b>
                        
                        SSL Certificate Management
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.9" data-path="doc/administering_onedata/firewall_setup.html">
            
                
                    <a href="../../doc/administering_onedata/firewall_setup.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.9.</b>
                        
                        Firewall Setup
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.10" data-path="doc/administering_onedata/luma.html">
            
                
                    <a href="../../doc/administering_onedata/luma.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.10.</b>
                        
                        Local User Mapping - LUMA
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.11" data-path="doc/administering_onedata/file_popularity.html">
            
                
                    <a href="../../doc/administering_onedata/file_popularity.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.11.</b>
                        
                        File-popularity
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.12" data-path="doc/administering_onedata/auto_cleaning.html">
            
                
                    <a href="../../doc/administering_onedata/auto_cleaning.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.12.</b>
                        
                        Auto-cleaning
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.13" data-path="doc/administering_onedata/administering_onedata_from_cli.html">
            
                
                    <a href="../../doc/administering_onedata/administering_onedata_from_cli.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.13.</b>
                        
                        Admin REST API
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="doc/advanced/index.html">
            
                
                    <a href="../../doc/advanced/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Advanced topics
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="doc/advanced/cdmi.html">
            
                
                    <a href="../../doc/advanced/cdmi.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        CDMI API
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../" >Onedata Documentation</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="oneprovider-installation-tutorial">Oneprovider installation tutorial</h1>
<!-- toc -->
<ul>
<li><a href="#installation">Installation</a><ul>
<li><a href="#prerequisites">Prerequisites</a><ul>
<li><a href="#increase-maximum-number-of-opened-files">Increase maximum number of opened files</a></li>
<li><a href="#swap-preference-settings">Swap preference settings</a></li>
<li><a href="#disable-transparent-huge-pages-feature">Disable Transparent Huge Pages feature</a></li>
<li><a href="#node-hostname">Node hostname</a></li>
<li><a href="#python">Python</a></li>
</ul>
</li>
<li><a href="#onedatify-based-setup">Onedatify based setup</a></li>
<li><a href="#docker-based-setup">Docker based setup</a><ul>
<li><a href="#customizing-oneprovider-docker-compose-script">Customizing Oneprovider Docker Compose script</a></li>
</ul>
</li>
<li><a href="#installation-from-distribution-packages">Installation from distribution packages</a><ul>
<li><a href="#package-installation">Package installation</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#configuration">Configuration</a><ul>
<li><a href="#setting-up-certificates">Setting up certificates</a></li>
<li><a href="#security-and-recommended-firewall-settings">Security and recommended firewall settings</a></li>
<li><a href="#cluster-configuration-for-package-based-deployment">Cluster configuration for package based deployment</a></li>
<li><a href="#advanced-configuration">Advanced configuration</a></li>
</ul>
</li>
<li><a href="#running">Running</a><ul>
<li><a href="#running-docker-based-installation-using-systemd">Running Docker based installation using systemd</a></li>
<li><a href="#running-package-based-installation">Running package based installation</a></li>
<li><a href="#monitoring">Monitoring</a></li>
<li><a href="#logs">Logs</a><ul>
<li><a href="#docker-based-deployment">Docker based deployment</a></li>
<li><a href="#package-based-deployment">Package based deployment</a></li>
<li><a href="#enabling-debug-logs">Enabling debug logs</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#upgrading">Upgrading</a><ul>
<li><a href="#docker-based-installation">Docker based installation</a></li>
<li><a href="#package-based-installation">Package based installation</a></li>
</ul>
</li>
<li><a href="#typical-administration-tasks">Typical administration tasks</a><ul>
<li><a href="#change-administrator-password">Change administrator password</a></li>
<li><a href="#adding-new-storage-to-oneprovider">Adding new storage to Oneprovider</a></li>
<li><a href="#support-user-spaces-with-storage">Support user spaces with storage</a></li>
<li><a href="#add-storage-with-existing-data">Add storage with existing data</a></li>
</ul>
</li>
</ul>
<!-- toc stop -->
<p>This section describes the steps needed to install and configure
<strong>Oneprovider</strong> service in production, either using Docker images or directly
using our packages. In order to deploy <strong>Oneprovider</strong>, it must be connected
during startup to an existing <strong>Onezone</strong> installation.</p>
<h2 id="installation">Installation</h2>
<p><strong>Oneprovider</strong> can be deployed using our <a href="https://hub.docker.com/r/onedata/oneprovider/" target="_blank">official Docker images</a>
on any <a href="https://docs.docker.com/engine/installation/#supported-platforms" target="_blank">Linux OS supporting Docker</a>
or using packages that we provide for <em>Ubuntu Xenial</em> and <em>CentOS 7</em>). Docker
based deployment is the recommended setup due to minimal requirements and
best portability.</p>
<p><strong>Oneprovider</strong> service can be deployed on multiple nodes for high-availability purpose, in
such case either the Docker setup or the packages need to be installed on all
nodes where the <strong>Oneprovider</strong> should be deployed. This tutorial assumes
<strong>Oneprovider</strong> will be installed on a single node.</p>
<h3 id="prerequisites">Prerequisites</h3>
<p>In order to ensure optimum performance of the <strong>Oneprovider</strong> service,
several low-level settings need to be tuned on the host machine. This applies
to both Docker based as well as package based installations, in particular to
nodes where Couchbase database instance are deployed.</p>
<p>After these settings are modified, the machine needs to be rebooted.</p>
<h4 id="increase-maximum-number-of-opened-files">Increase maximum number of opened files</h4>
<p>In order to install <strong>Oneprovider</strong> service on one of the supported operating systems, first make sure that the maximum limit of opened files is sufficient (preferably 63536, but below <code>/proc/sys/fs/file-max</code>). The limit can be checked using:</p>
<pre><code class="lang-sh"><span class="hljs-built_in">ulimit</span> -n
<span class="hljs-number">1024</span>
</code></pre>
<p>If necessary, increase the limit using:</p>
<pre><code class="lang-sh">$ sudo sh -c <span class="hljs-string">&apos;echo &quot;* soft nofile 63536&quot; &gt;&gt; /etc/security/limits.conf&apos;</span>
$ sudo sh -c <span class="hljs-string">&apos;echo &quot;* hard nofile 63536&quot; &gt;&gt; /etc/security/limits.conf&apos;</span>
</code></pre>
<blockquote>
<p>It might be also necessary to setup the limit in /etc/systemd/system.conf:</p>
<pre><code class="lang-sh">sudo sh -c <span class="hljs-string">&apos;echo DefaultLimitNOFILE=65536 &gt;&gt; /etc/systemd/system.conf&apos;</span>
sudo systemctl daemon-reexec
</code></pre>
</blockquote>
<h4 id="swap-preference-settings">Swap preference settings</h4>
<p>Make sure that the swap preference (i.e. <em>swappiness</em>) is set to <code>0</code> (or at most <code>1</code> - see <a href="https://developer.couchbase.com/documentation/server/current/install/install-swap-space.html" target="_blank">here</a> for details):</p>
<pre><code class="lang-sh">$ cat /proc/sys/vm/swappiness
<span class="hljs-number">60</span>
</code></pre>
<p>and if necessary decrease it using:</p>
<pre><code class="lang-sh">$ sudo sh -c <span class="hljs-string">&apos;echo &quot;vm.swappiness=0&quot; &gt;&gt; /etc/sysctl.d/50-swappiness.conf&apos;</span>
</code></pre>
<h4 id="disable-transparent-huge-pages-feature">Disable Transparent Huge Pages feature</h4>
<p>By default, many Linux machines have the Transparent Huge Pages feature enabled, which somehwat improves performance of machines running multiple application at once (e.g. desktop operation systems), however it deteriorates the performance of most database-heavy applications, such as <strong>Oneprovider</strong>.</p>
<p>These settings can be checked using the following commands (the output shown below presents the expected settings):</p>
<pre><code>$ cat /sys/kernel/mm/transparent_hugepage/enabled
always madvise [never]

$ cat /sys/kernel/mm/transparent_hugepage/defrag
always madvise [never]
</code></pre><p>If any of the settings is different than the above, they should be changed permanently, which can be achieved for instance by creating a simple <strong>systemd</strong> unit file <code>/etc/systemd/system/disable-thp.service</code>:</p>
<pre><code>[Unit]
Description=Disable Transparent Huge Pages

[Service]
Type=oneshot
ExecStart=/bin/sh -c &quot;/bin/echo &apos;never&apos; | /usr/bin/tee /sys/kernel/mm/transparent_hugepage/enabled&quot;
ExecStart=/bin/sh -c &quot;/bin/echo &apos;never&apos; | /usr/bin/tee /sys/kernel/mm/transparent_hugepage/defrag&quot;

[Install]
WantedBy=multi-user.target
</code></pre><p>and enabling it on system startup using:</p>
<pre><code>$ sudo systemctl enable disable-thp.service
$ sudo systemctl start disable-thp.service
</code></pre><h4 id="node-hostname">Node hostname</h4>
<p>Make sure that the machine has a resolvable, domain-style hostname (it can be Fully Qualified Domain Name or just a proper entry in <code>/etc/hostname</code> and <code>/etc/hosts</code>) - for this tutorial it is set to <code>oneprovider-example.com</code>.</p>
<p>Following command examples assumes an environment variable <code>ONEPROVIDER_HOST</code> is available, for instance:</p>
<pre><code class="lang-sh">$ <span class="hljs-built_in">export</span> ONEPROVIDER_HOST=<span class="hljs-string">&quot;oneprovider-example.com&quot;</span>
</code></pre>
<h4 id="python">Python</h4>
<p>Make sure that python 2.x is installed on the machine. For example:</p>
<pre><code class="lang-sh">$ python -V
Python <span class="hljs-number">2.7</span>.<span class="hljs-number">12</span>
</code></pre>
<h3 id="onedatify-based-setup">Onedatify based setup</h3>
<p>The easiest way to deploy <strong>Oneprovider</strong> is using <strong>Onedatify</strong>. The deployment procedure is described <a href="onedatify_deploy.html">here</a>.</p>
<h3 id="docker-based-setup">Docker based setup</h3>
<p><strong>Oneprovider</strong> installation using Docker is very straightforward. This type of deployment requires that docker and docker-compose are installed on your server.</p>
<h4 id="customizing-oneprovider-docker-compose-script">Customizing Oneprovider Docker Compose script</h4>
<p>In case of Docker based deployment all configuration information needed to install Oneprovider can be included directly in the Docker Compose script. This tutorial assumes that all <strong>Oneprovider</strong> configuration and log files will be stored in the directory <code>/opt/onedata/oneprovider</code> on the host machine, but you can use any directory to which Docker has access to. Make sure the partition where the <code>/opt</code> directory is mounted has at least 20GB of free space for logs and database files. For large systems with large numbers of files (&gt;1M files) the space should be much bigger. Also consider setting up the <code>persistence</code> directory on a separate partition with backup.</p>
<p>The following assumes you have prepared the following directory structure:</p>
<pre><code class="lang-sh">$ sudo mkdir -p /opt/onedata/oneprovider
$ sudo mkdir /opt/onedata/oneprovider/certs
$ sudo mkdir /opt/onedata/oneprovider/persistence
</code></pre>
<p>Create the following Docker Compose file in <code>/opt/onedata/oneprovider/docker-compose.yml</code>:</p>
<pre><code class="lang-Yaml">version: &apos;2.0&apos;
services:
  node1.oneprovider.localhost:
    # Oneprovider Docker image version
    image: onedata/oneprovider:21.02.1
    # Hostname (in this case the hostname inside Docker network)
    hostname: node1.oneprovider.localhost
    # dns: 8.8.8.8 # Optional, in case Docker containers have no DNS access
    # Host network mode is preferred, but on some systems may not work (e.g. CentOS)
    # To use bridge network
    network_mode: host
    # Friendly name of the Oneprovider Docker container
    container_name: oneprovider-1
    # Mapping of volumes to Oneprovider container
    volumes:
       - &quot;/var/run/docker.sock:/var/run/docker.sock&quot;
       # Oneprovider runtime files
       - &quot;/opt/onedata/oneprovider/persistence:/volumes/persistence&quot;
       # Data storage directories
       - &quot;/mnt/nfs:/volumes/storage&quot;
       # Additional, trusted CA certificates (all files from this directory will be added)
       - &quot;/opt/onedata/oneprovider/cacerts:/etc/op_worker/cacerts&quot;
       # Uncoment lines below if you disabled the built-in Let&apos;s Encrypt client
       ## SSL certificate
       #- &quot;/opt/onedata/oneprovider/certs/cert.pem:/etc/op_panel/certs/web_cert.pem&quot;
       ## SSL certificate key
       #- &quot;/opt/onedata/oneprovider/certs/key.pem:/etc/op_panel/certs/web_key.pem&quot;
       ## Certificate chain for the TLS certificate above
       #- &quot;/opt/onedata/oneprovider/certs/cacert.pem:/etc/op_panel/certs/web_chain.pem&quot;
    # Expose the necessary ports from Oneprovider container to the host
    # This section can be commented when using host mode networking
    ports:
      - &quot;80:80&quot;
      - &quot;443:443&quot;
      - &quot;6665:6665&quot;
      - &quot;9443:9443&quot;
    environment:
      # Force Onepanel to read configuration from environment variable
      ONEPANEL_BATCH_MODE: &quot;true&quot;
      # Provide initial Oneprovider configuration for Onepanel in environment variable
      ONEPROVIDER_CONFIG: |
        # Cluster configuration allows to specify distribution of Oneprovider
        # components over multiple nodes - here we deploy entire service on
        # a single node
        cluster:
          # Domain name of the provider within Docker network, will be appended
          # to all nodes specified below
          domainName: &quot;oneprovider.localhost&quot;
          autoDeploy: true
          nodes:
            n1:
              hostname: &quot;node1&quot;
          managers:
            mainNode: &quot;n1&quot;
            nodes:
              - &quot;n1&quot;
          workers:
            nodes:
              - &quot;n1&quot;
          databases:
            # Per node Couchbase cache size in MB for all buckets
            serverQuota: 4096
            # Per bucket Couchbase cache size in MB across the cluster
            bucketQuota: 4096
            nodes:
              - &quot;n1&quot;
          storages:
            # Add initial storage resource (optional - can be added later)
            # In this example NFS mounted at /mnt/nfs on the host, which is
            # mounted to /volumes/storage directory inside Docker container
            NFS:
              type: &quot;posix&quot;
              mountPoint: &quot;/volumes/storage&quot;
        oneprovider:
          geoLatitude: 50.0646501
          geoLongitude: 19.9449799
          register: true
          name: &quot;ONEPROVIDER-DEMO&quot;
          adminEmail: &quot;admin@oneprovider-example.tk&quot;
          # Use built-in Let&apos;s Encrypt client to obtain and renew certificates
          letsEncryptEnabled: true
          # Automatically register this Oneprovider in Onezone without subdomain delegation
          subdomainDelegation: false
          domain: &quot;oneprovider-example.tk&quot;

          # Alternatively:
          ## Automatically register this Oneprovider in Onezone with subdomain delegation
          # subdomainDelegation: true
          # subdomain: oneprovider-example # Domain will be &quot;oneprovider-example.onezone-example.tk&quot;
        onezone:
          # Address of the Onezone at which this Oneprovider will register
          domainName: &quot;onezone-example.tk&quot;
        onepanel:
          # Create initially 1 administrator and 1 regular user
          users:
            &quot;admin&quot;:
              password: &quot;password&quot;
              userRole: &quot;admin&quot;
            &quot;user&quot;:
              password: &quot;password&quot;
              userRole: &quot;regular&quot;
</code></pre>
<p>To install the necessary Docker images on the machine run:</p>
<pre><code class="lang-sh">$ docker-compose <span class="hljs-operator">-f</span> /opt/onedata/oneprovider/docker-compose.yml pull
</code></pre>
<h3 id="installation-from-distribution-packages">Installation from distribution packages</h3>
<p>The following instructions are based on Ubuntu Xenial.</p>
<h4 id="package-installation">Package installation</h4>
<p>Now in order to install <strong>Oneprovider</strong> service, it should be enough to execute our install script, which automatically detects operating system version, adds our repository and installs required packages:</p>
<pre><code class="lang-sh">$ curl <span class="hljs-operator">-s</span>S  http://get.onedata.org/oneprovider.sh | bash
</code></pre>
<p>Alternatively, the necessary packages can be installed manually:</p>
<pre><code class="lang-sh"><span class="hljs-comment"># Add Onedata package repository</span>
$ sudo sh -c <span class="hljs-string">&apos;curl -sSL  http://packages.onedata.org/onedata.gpg.key | apt-key add -&apos;</span>
$ sudo sh -c <span class="hljs-string">&apos;echo &quot;deb http://packages.onedata.org/apt/ubuntu/xenial xenial main&quot; &gt; /etc/apt/sources.list.d/onedata.list&apos;</span>
$ sudo sh -c <span class="hljs-string">&apos;echo &quot;deb-src http://packages.onedata.org/apt/ubuntu/xenial xenial main&quot; &gt;&gt; /etc/apt/sources.list.d/onedata.list&apos;</span>

<span class="hljs-comment"># Update package list</span>
$ sudo apt update

<span class="hljs-comment"># Install packages</span>
$ <span class="hljs-built_in">export</span> ONEPANEL_AUTOSTART=<span class="hljs-literal">false</span> <span class="hljs-comment"># Disable automatic Onepanel start</span>
$ sudo apt install op-panel
$ sudo apt install cluster-manager
$ sudo apt install op-worker
$ sudo apt install couchbase-server-community
$ sudo apt install oneprovider
</code></pre>
<blockquote>
<p>Sometimes Couchbase service fails to start automatically during installation, in such case it has to be restarted manually using <code>$ sudo systemctl restart couchbase-server.service</code> and then install Oneprovider again <code>$ sudo apt install oneprovider</code></p>
</blockquote>
<h2 id="configuration">Configuration</h2>
<h3 id="setting-up-certificates">Setting up certificates</h3>
<p>Since release 18.02.0-beta5, <strong>Oneprovider</strong> supports automatic certificate
management backed by Let&apos;s Encrypt. To use this option, it is only necessary
to enable this feature in <strong>Oneprovider</strong> Docker Compose configuration file
(see above) or via GUI.</p>
<p>If you prefer to obtain and install certificates for <strong>Oneprovider</strong> service
manually, modify the Docker Compose file to mount PEM files inside the
container using paths listed in <a href="ssl_certificate_management.html">TLS certificate management</a>.</p>
<h3 id="security-and-recommended-firewall-settings">Security and recommended firewall settings</h3>
<p><strong>Oneprovider</strong> service requires several TCP ports (<code>80</code>,<code>443</code>,<code>6665</code>,<code>9443</code>) to be opened for proper operation. Some of these ports can be limited to internal network, in particular <code>9443</code> for <strong>Onepanel</strong> management interface. For more details on these ports see here.</p>
<p>Furthermore, on all nodes of <strong>Oneprovider</strong> deployment where Couchbase
instance is deployed, it exposes several additional ports. This means that
the Couchbase <a href="https://developer.couchbase.com/documentation/server/4.6/security/security-intro.html" target="_blank">security guidelines</a>
should be also followed.</p>
<p>For more information about ports setup see <a href="firewall_setup.html">Firewal setup</a></p>
<h3 id="cluster-configuration-for-package-based-deployment">Cluster configuration for package based deployment</h3>
<p>This tutorial assumed that the cluster configuration is provided directly in the Docker Compose file. However for package based installation the cluster configuration has to be performed separately. It can be done using the Onepanel web based interface. <strong>Onepanel</strong> administration service is automatically started after installation and can be accessed from <code>https://oneprovider-example.tk:9443</code> port to configure <strong>Oneprovider</strong> instance. In case it was not started properly, it can be restarted using <code>systemctl</code> command:</p>
<pre><code>$ sudo systemctl restart op_panel.service
</code></pre><p>Open <code>https://oneprovider-example.tks:9443</code> using any web browser and continue through the following steps:</p>
<ul>
<li><p>Login using default credentials specified in (e.g. <code>admin:password</code>)</p>
<p align="center"><img src="../img/admin/op_tutorial_panel_login.png" width="720"></p>
</li>
<li><p>Initialize the cluster setup</p>
<p align="center"><img src="../img/admin/op_tutorial_panel_start.png" width="720"></p>
</li>
<li><p>Select hosts in the cluster which will have specific roles (leave as is)</p>
<p align="center"><img src="../img/admin/op_tutorial_panel_hosts_selection.png" width="720"></p>
</li>
<li><p>Provide Onezone details including subdomain delegation request</p>
<p align="center"><img src="../img/admin/op_tutorial_panel_registration.png" width="720"></p>
</li>
<li><p>Provide the external IP address of the Oneprovider cluster and click &quot;Setup IP address&quot;.</p>
<p align="center"><img src="../img/admin/op_tutorial_panel_ip_address.png" width="720"></p>
</li>
<li><p>Check the DNS settings and click &quot;Perform check&quot;. If it fails then check that the DNS records, which are displayed exists. </p>
<p align="center"><img src="../img/admin/op_tutorial_panel_dns_setup.png" width="640"></p>
</li>
<li><p>Click &quot;Proceed&quot; when the DNS check succeeds.</p>
<p align="center"><img src="../img/admin/op_tutorial_panel_dns_setup_2.png" width="640"></p>
</li>
<li><p>Click &quot;Obtain certificate&quot; to automatically obtain a web certificate from Let&apos;s encrypt.</p>
<p align="center"><img src="../img/admin/op_tutorial_panel_web_cert.png" width="640"></p>
</li>
<li><p>Add storage</p>
<p align="center"><img src="../img/admin/op_tutorial_add_storage.png" width="720"></p>
</li>
<li><p>Verify the storage was added successfully and click &quot;Finish&quot;.</p>
<p align="center"><img src="../img/admin/op_tutorial_storage_added.png" width="720"></p>
</li>
<li><p>Wait for registration and deployment to complete</p>
<p align="center"><img src="../img/admin/op_tutorial_panel_success.png" width="720"></p>

</li>
</ul>
<p>After this step succeeds, <strong>Oneprovider</strong> should be running and opening <code>https://oneprovider-example.tk</code> should redirect to it&apos;s <strong>Onezone</strong> login page, in this case <code>https://onezone-example.tk</code>.</p>
<h3 id="advanced-configuration">Advanced configuration</h3>
<p>After installation several <strong>Oneprovider</strong> parameters can be further fine-tuned using erlang application configuration files.</p>
<p>The basis for configuration are read-only files located at <code>/var/lib/op_worker/app.config</code> and <code>/var/lib/op_panel/app.config</code>. They can be used for reference for defaults in use and extensive comments explaining containted variables, but should not be modified.</p>
<p>Settings contained in the <code>app.config</code> files are overriden by configuration written by Onepanel during deployment in <code>autogenerated.config</code> files and by option custom user config file <code>overlay.config</code>.</p>
<p>The autogenerated file is located at <code>/etc/op_worker/autogenerated.config</code> and should not by modified by hand.</p>
<p>For custom configuration a new file <code>/etc/op_worker/overlay.config</code> or <code>/etc/op_panel/overlay.config</code> should be created. Variables set there will override those from <code>app.config</code> and <code>autogenerated.config</code> files.</p>
<h2 id="running">Running</h2>
<h3 id="running-docker-based-installation-using-systemd">Running Docker based installation using systemd</h3>
<p>Docker based installation can be conveniently managed using a <strong>systemd</strong> service unit. Simply create a <code>/etc/systemd/system/oneprovider.service</code>:</p>
<pre><code>[Unit]
Description=Oneprovider Service
After=docker.service
Requires=docker.service

[Service]
ExecStartPre=/usr/bin/docker-compose -f /opt/onedata/oneprovider/docker-compose.yml down
ExecStart=/usr/bin/docker-compose -f /opt/onedata/oneprovider/docker-compose.yml up --abort-on-container-exit --no-recreate
ExecStop=-/usr/bin/docker-compose -f /opt/onedata/oneprovider/docker-compose.yml down
Restart=always

[Install]
WantedBy=multi-user.target
</code></pre><p>Then the <strong>Oneprovider</strong> service can be managed using standard <code>systemctl</code> command:</p>
<pre><code># Enable Oneprovider service on machine startup
$ sudo systemctl enable oneprovider.service

# Start Oneprovider service
$ sudo systemctl start oneprovider.service
$ sudo systemctl status oneprovider.service
...
May 25 23:25:32 localhost docker-compose[13499]: oneprovider-1                  | Congratulations! oneprovider has been successfully started.

# Stopping Oneprovider service
$ sudo systemctl stop oneprovider.service

# Restarting Oneprovider service while keeping all persistent files
$ sudo systemctl restart oneprovider.service

# Remove Oneprovider data files
$ sudo systemctl stop oneprovider.service
$ sudo rm -rf /opt/onedata/oneprovider/persistence/*
</code></pre><h3 id="running-package-based-installation">Running package based installation</h3>
<p>After web based Onepanel setup is complete, <strong>Oneprovider</strong> service should be operating normally. However, <strong>Oneprovider</strong> service can be manually started and stopped when needed, it is composed of several <strong>systemd</strong> units:</p>
<table>
<thead>
<tr>
<th style="text-align:left">Name</th>
<th style="text-align:left">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>couchbase-server.service</code></td>
<td style="text-align:left">Couchbase server for <strong>Oneprovider</strong> metadata</td>
</tr>
<tr>
<td style="text-align:left"><code>op_panel.service</code></td>
<td style="text-align:left"><strong>Onepanel</strong> administration service</td>
</tr>
<tr>
<td style="text-align:left"><code>cluster_manager.service</code></td>
<td style="text-align:left">The process for managing a cluster <strong>Oneprovider</strong> deployment</td>
</tr>
<tr>
<td style="text-align:left"><code>op_worker.service</code></td>
<td style="text-align:left">The main <strong>Oneprovider</strong> service</td>
</tr>
</tbody>
</table>
<h3 id="monitoring">Monitoring</h3>
<p>Monitoring information is available on a specific port and provides basic status of all <strong>Oneprovider</strong> service functional components. The service status can be monitored using a simple script like below or using our <a href="https://github.com/onedata/nagios-plugins-onedata" target="_blank">Nagios scripts</a>:</p>
<pre><code class="lang-xml">curl -sS https://$ONEPROVIDER_HOST/nagios | xmllint --format -
<span class="hljs-pi">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">healthdata</span> <span class="hljs-attribute">date</span>=<span class="hljs-value">&quot;2017/05/27 22:48:16&quot;</span> <span class="hljs-attribute">status</span>=<span class="hljs-value">&quot;ok&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">op_worker</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;op_worker@oneprovider-example.com&quot;</span> <span class="hljs-attribute">status</span>=<span class="hljs-value">&quot;ok&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">node_manager</span> <span class="hljs-attribute">status</span>=<span class="hljs-value">&quot;ok&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">request_dispatcher</span> <span class="hljs-attribute">status</span>=<span class="hljs-value">&quot;ok&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">datastore_worker</span> <span class="hljs-attribute">status</span>=<span class="hljs-value">&quot;ok&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">dbsync_worker</span> <span class="hljs-attribute">status</span>=<span class="hljs-value">&quot;ok&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">dns_worker</span> <span class="hljs-attribute">status</span>=<span class="hljs-value">&quot;ok&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">fslogic_deletion_worker</span> <span class="hljs-attribute">status</span>=<span class="hljs-value">&quot;ok&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">fslogic_worker</span> <span class="hljs-attribute">status</span>=<span class="hljs-value">&quot;ok&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">monitoring_worker</span> <span class="hljs-attribute">status</span>=<span class="hljs-value">&quot;ok&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">session_manager_worker</span> <span class="hljs-attribute">status</span>=<span class="hljs-value">&quot;ok&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">space_sync_worker</span> <span class="hljs-attribute">status</span>=<span class="hljs-value">&quot;ok&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">subscriptions_worker</span> <span class="hljs-attribute">status</span>=<span class="hljs-value">&quot;ok&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">tp_router</span> <span class="hljs-attribute">status</span>=<span class="hljs-value">&quot;ok&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">dns_listener</span> <span class="hljs-attribute">status</span>=<span class="hljs-value">&quot;ok&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">gui_listener</span> <span class="hljs-attribute">status</span>=<span class="hljs-value">&quot;ok&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">nagios_listener</span> <span class="hljs-attribute">status</span>=<span class="hljs-value">&quot;ok&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">protocol_listener</span> <span class="hljs-attribute">status</span>=<span class="hljs-value">&quot;ok&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">provider_listener</span> <span class="hljs-attribute">status</span>=<span class="hljs-value">&quot;ok&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">redirector_listener</span> <span class="hljs-attribute">status</span>=<span class="hljs-value">&quot;ok&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">rest_listener</span> <span class="hljs-attribute">status</span>=<span class="hljs-value">&quot;ok&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">op_worker</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">healthdata</span>&gt;</span>
</code></pre>
<p>If all components report <code>&quot;ok&quot;</code> and overall healthdata status is also <code>&quot;ok&quot;</code>, it means the service is running properly.</p>
<h3 id="logs">Logs</h3>
<p>In case of issues, both <strong>Onepanel</strong> and <strong>Oneprovider</strong> logs should be checked and included in any reported issues.</p>
<p><strong>Onepanel</strong> logs should be consulted for issues related to Oneprovider deployment, registering new storage backends or supporting spaces. <strong>Oneprovider</strong> logs should contain errors related to data management tasks and replication.</p>
<h4 id="docker-based-deployment">Docker based deployment</h4>
<p>In case of Docker based deployment, assuming the paths were set as in the tutorial, the following directories contain logs:</p>
<pre><code># Onepanel logs
sudo ls /opt/onedata/oneprovider/persistence/var/log/op_panel/
cmd.log debug.log error.log info.log run_erl.log

# Oneprovider logs
sudo ls /opt/onedata/oneprovider/persistence/var/log/oz_worker/
debug.log error.log info.log run_erl.log
</code></pre><h4 id="package-based-deployment">Package based deployment</h4>
<p>In case of package based deployment, the following directories contain logs:</p>
<pre><code># Onepanel logs
sudo ls /var/log/op_panel/
cmd.log debug.log error.log info.log run_erl.log

# Oneprovider logs
sudo ls /var/log/op_worker/
debug.log error.log info.log run_erl.log
</code></pre><h4 id="enabling-debug-logs">Enabling debug logs</h4>
<p>By default, logs on the debug level are disabled, as they have a heavy impact on
system performance. However, there are cases when you might want to turn them 
on for some time to identify problems. To do so, you need to attach to the
Erlang console of the node and execute <code>logger:set_loglevel(debug).</code>, like this:</p>
<pre><code>~$ op_worker attach-direct
</code></pre><p>You will be attached to the console and see the following prompt:</p>
<pre><code>Direct Shell: Use &quot;Ctrl-D&quot; to quit. &quot;Ctrl-C&quot; will terminate the op_worker node.
Attaching to /tmp/op_worker/erlang.pipe.1 (^D to exit)

(op_worker@node1.oneprovider.local)11&gt;
</code></pre><p>Enter the command (the <code>.</code> at the end is required) and press <code>[Enter]</code>:</p>
<pre><code>(op_worker@node1.oneprovider.local)11&gt; logger:set_loglevel(debug).
ok
</code></pre><p>Detach from the console by pressing <code>[Ctrl + D]</code> - pressing <code>[Ctrl + C]</code> will 
kill the node!</p>
<pre><code>(op_worker@node1.oneprovider.local)12&gt; [Quit]
~$
</code></pre><p>From now on, the debug logs will be written to the <code>debug.log</code> file as they 
appear. Remember to turn off the debug logs when you are finished:</p>
<pre><code>~$ op_worker attach-direct

(op_worker@node1.oneprovider.local)13&gt; logger:set_loglevel(info).
ok

^D
</code></pre><blockquote>
<p>You can do the same for Onepanel, just replace <code>op_worker</code> with <code>op_panel</code>.</p>
</blockquote>
<h2 id="upgrading">Upgrading</h2>
<h3 id="docker-based-installation">Docker based installation</h3>
<p>To upgrade a Docker based installation, stop the <strong>Oneprovider</strong> service using:</p>
<pre><code>$ sudo systemctl stop oneprovider.service
</code></pre><p>and modify the Oneprovider Docker image version in <code>/opt/onedata/oneprovider/docker-compose.yml</code>:</p>
<pre><code class="lang-yaml">  ...
  node1.onezone.localhost:
    # Oneprovider Docker image version
    image: onedata/oneprovider:VERSION
    ...
</code></pre>
<p>and restart the service:</p>
<pre><code>$ sudo systemctl start oneprovider.service
</code></pre><h3 id="package-based-installation">Package based installation</h3>
<p>To upgrade <strong>Oneprovider</strong> deployment perform the following steps. In case <strong>Oneprovider</strong> is running on multiple nodes, stop the services first on all nodes, perform upgrade and then restart the services.</p>
<pre><code class="lang-sh"><span class="hljs-comment"># Stop Oneprovider components</span>
$ sudo systemctl stop op_panel.service
$ sudo systemctl stop op_worker.service
$ sudo systemctl stop cluster_manager.service
$ sudo systemctl stop couchbase-server.service

<span class="hljs-comment"># Upgrade packages</span>
$ sudo apt upgrade onezone

<span class="hljs-comment"># Start Oneprovider components</span>
$ sudo systemctl start couchbase-server.service
$ sudo systemctl start cluster_manager.service
$ sudo systemctl start op_panel.service
$ sudo systemctl start op_worker.service
</code></pre>
<h2 id="typical-administration-tasks">Typical administration tasks</h2>
<p>This section presents few typical administration tasks that can be performed by <strong>Oneprovider</strong> admins.</p>
<h3 id="change-administrator-password">Change administrator password</h3>
<p>The administrator password to the <strong>Oneprovider</strong> administration panel can be changed easily within GUI (<code>https://$ONEPROVIDER_HOST:9443</code>) or using the REST API:</p>
<pre><code class="lang-sh">curl <span class="hljs-operator">-s</span>S -X PATCH -H <span class="hljs-string">&apos;Content-type: application/json&apos;</span> \
<span class="hljs-operator">-d</span> <span class="hljs-string">&apos;{&quot;username&quot;: &quot;admin&quot;, &quot;password&quot;: &quot;NewPassword&quot;}&apos;</span> -u admin:password \
https://<span class="hljs-variable">$ONEPROVIDER_HOST</span>:<span class="hljs-number">9443</span>/api/v3/onepanel/users
</code></pre>
<h3 id="adding-new-storage-to-oneprovider">Adding new storage to Oneprovider</h3>
<p>Storage resources can be conveniently added to a <strong>Oneprovider</strong> instance using the Onepanel GUI, in menu <strong>Storages</strong> and click <strong>Add storage</strong> in the top right corner:</p>
<ul>
<li>Select storage type and provider required connection details (example for S3):<p align="center"><img src="../img/admin/op_panel_tutorial_add_more_storage.png" width="720"></p>

</li>
</ul>
<p>From this point on when supporting user spaces, this storage will be available as an option.
You can read more about storage configuration <a href="storage_configuration.html">here</a>.</p>
<h3 id="support-user-spaces-with-storage">Support user spaces with storage</h3>
<p>The only way users can use the <strong>Oneprovider</strong> storage resources is by requesting storage support from <strong>Oneprovider</strong> administrator, by sending them <strong>Space support</strong> tokens created in the <strong>Onezone</strong> user interface.</p>
<p>Using the token, the administrator can support the space on a specific storage using the web interface:</p>
<ul>
<li>Select storage type, paste support token received from user and specify storage quota for the user:<p align="center"><img src="../img/admin/op_tutorial_support_space.png" width="720"></p>

</li>
</ul>
<h3 id="add-storage-with-existing-data">Add storage with existing data</h3>
<p>Oneprovider supports direct import of legacy storage data - without the need of copying the data.
You can learn more in the <a href="storage_import.html">storage import</a> section.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../../doc/administering_onedata/onezone_tutorial.html" class="navigation navigation-prev " aria-label="Previous page: Onezone setup"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../../doc/administering_onedata/creating_user_accounts.html" class="navigation navigation-next " aria-label="Next page: Creating User accounts"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../../gitbook/app.js"></script>

    
    <script src="../../gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-onedata-theme/nanoscroller.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-onedata-theme/onedata.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-onedata-theme/w3data.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-toggle-chapters/toggle.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-responsive-iframes/plugin.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-ga/plugin.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"image-captions":{"caption":"","variable_name":"_pictures"},"ga":{"token":"UA-63301911-1","configuration":"auto"},"favicon":"doc/img/onedata.ico","search":{"maxIndexSize":1000000},"onedata-theme":{},"youtube":{},"toggle-chapters":{},"toc":{},"include":{},"responsive-iframes":{},"custom-favicon":{},"styles-sass":{},"include-html":{},"highlight":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        <!-- body:end -->
<!-- body:end -->
    </body>
    <!-- End of book Onedata Documentation -->
<!-- End of book Onedata Documentation -->
</html>
