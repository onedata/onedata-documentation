<!DOCTYPE HTML>
<html lang="en" >
    <!-- Start book Onedata Documentation -->
<!-- Start book Onedata Documentation -->
    <head>
        <!-- head:start -->
<!-- head:start -->
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Tokens | Onedata Documentation</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-onedata-theme/nanoscroller.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-onedata-theme/onedata.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-onedata-theme/rest.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-image-captions/image-captions.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-toggle-chapters/toggle.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-responsive-iframes/plugin.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    
        <link rel="stylesheet" href="../../website-1686572662585.css">
    

        
    
    
    <link rel="next" href="../../doc/using_onedata/oneclient.html" />
    
    
    <link rel="prev" href="../../doc/using_onedata/views.html" />
    

        <!-- head:end -->
<!-- head:end -->
    </head>
    <body>
        <!-- body:start -->
<!-- body:start -->
        
    <div class="book"
        data-level="2.11"
        data-chapter-title="Tokens"
        data-filepath="doc/using_onedata/tokens.md"
        data-basepath="../.."
        data-revision="Mon Jun 12 2023 12:24:21 GMT+0000 (UTC)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Onedata Documentation
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" >
            
            <span><b>1.</b> Getting Started</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="doc/getting_started/what_is_onedata.html">
            
                
                    <a href="../../doc/getting_started/what_is_onedata.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        What is Onedata?
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="doc/getting_started/downloading_onedata.html">
            
                
                    <a href="../../doc/getting_started/downloading_onedata.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Downloading Onedata
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="doc/getting_started/user_onedata_101.html">
            
                
                    <a href="../../doc/getting_started/user_onedata_101.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        User Quickstart
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="doc/getting_started/admin_onedata_101.html">
            
                
                    <a href="../../doc/getting_started/admin_onedata_101.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.4.</b>
                        
                        Admin Quickstart
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="doc/administering_onedata/onezone_quick_tutorial.html">
            
                
                    <a href="../../doc/administering_onedata/onezone_quick_tutorial.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.4.1.</b>
                        
                        Onezone deploy
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="doc/administering_onedata/oneprovider_quick_tutorial.html">
            
                
                    <a href="../../doc/administering_onedata/oneprovider_quick_tutorial.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.4.2.</b>
                        
                        Oneprovider deploy
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" >
            
            <span><b>2.</b> Onedata for users</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="doc/user_guide.html">
            
                
                    <a href="../../doc/user_guide.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Overview
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="doc/using_onedata/account_management.html">
            
                
                    <a href="../../doc/using_onedata/account_management.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Account Management
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="doc/using_onedata/space_management.html">
            
                
                    <a href="../../doc/using_onedata/space_management.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        Space Management
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="doc/using_onedata/space_collaboration.html">
            
                
                    <a href="../../doc/using_onedata/space_collaboration.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                        Space Collaboration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="doc/using_onedata/group_management.html">
            
                
                    <a href="../../doc/using_onedata/group_management.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.</b>
                        
                        Group Management
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="doc/using_onedata/privilege_management.html">
            
                
                    <a href="../../doc/using_onedata/privilege_management.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.6.</b>
                        
                        Privilege Management
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="doc/using_onedata/file_management.html">
            
                
                    <a href="../../doc/using_onedata/file_management.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.7.</b>
                        
                        File Management
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="doc/using_onedata/replication_management.html">
            
                
                    <a href="../../doc/using_onedata/replication_management.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.8.</b>
                        
                        Replication and Transfer Management
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.9" data-path="doc/using_onedata/metadata.html">
            
                
                    <a href="../../doc/using_onedata/metadata.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.9.</b>
                        
                        Metadata
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.10" data-path="doc/using_onedata/views.html">
            
                
                    <a href="../../doc/using_onedata/views.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.10.</b>
                        
                        Views
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="2.11" data-path="doc/using_onedata/tokens.html">
            
                
                    <a href="../../doc/using_onedata/tokens.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.11.</b>
                        
                        Tokens
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.12" data-path="doc/using_onedata/oneclient.html">
            
                
                    <a href="../../doc/using_onedata/oneclient.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.12.</b>
                        
                        Oneclient CLI
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.13" data-path="doc/using_onedata/docker_volume_plugin.html">
            
                
                    <a href="../../doc/using_onedata/docker_volume_plugin.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.13.</b>
                        
                        Docker volume plugin
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.14" data-path="doc/using_onedata/shares.html">
            
                
                    <a href="../../doc/using_onedata/shares.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.14.</b>
                        
                        Shares
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.15" data-path="doc/using_onedata/file_registration.html">
            
                
                    <a href="../../doc/using_onedata/file_registration.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.15.</b>
                        
                        File registration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.16" data-path="doc/using_onedata/handle_services.html">
            
                
                    <a href="../../doc/using_onedata/handle_services.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.16.</b>
                        
                        Handle Services
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.17" data-path="doc/using_onedata/using_onedata_from_cli.html">
            
                
                    <a href="../../doc/using_onedata/using_onedata_from_cli.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.17.</b>
                        
                        Using REST API
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.18" data-path="doc/using_onedata/onedatafs.html">
            
                
                    <a href="../../doc/using_onedata/onedatafs.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.18.</b>
                        
                        OnedataFS Python interface
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.19" data-path="doc/using_onedata/jupyter_integration.html">
            
                
                    <a href="../../doc/using_onedata/jupyter_integration.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.19.</b>
                        
                        Jupyter integration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.20" data-path="doc/using_onedata/qos.html">
            
                
                    <a href="../../doc/using_onedata/qos.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.20.</b>
                        
                        Quality of Service
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" >
            
            <span><b>3.</b> Onedata for administrators</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="doc/admin_guide.html">
            
                
                    <a href="../../doc/admin_guide.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Overview
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="doc/system_requirements.html">
            
                
                    <a href="../../doc/system_requirements.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        System requirements
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="doc/compatibility_reference.html">
            
                
                    <a href="../../doc/compatibility_reference.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        Compatibility reference
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="Services overview.html">
            
            <span><b>3.4.</b> Services overview</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.4.1" data-path="doc/administering_onedata/onezone_overview.html">
            
                
                    <a href="../../doc/administering_onedata/onezone_overview.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.1.</b>
                        
                        Onezone overview
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4.2" data-path="doc/administering_onedata/provider_overview.html">
            
                
                    <a href="../../doc/administering_onedata/provider_overview.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.2.</b>
                        
                        Oneprovider overview
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4.3" data-path="doc/administering_onedata/onepanel_overview.html">
            
                
                    <a href="../../doc/administering_onedata/onepanel_overview.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.3.</b>
                        
                        Onepanel overview
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="doc/administering_onedata/deployment_tutorial.html">
            
                
                    <a href="../../doc/administering_onedata/deployment_tutorial.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        Installation tutorial
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.5.1" data-path="doc/administering_onedata/onedatify_deploy.html">
            
                
                    <a href="../../doc/administering_onedata/onedatify_deploy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.1.</b>
                        
                        Oneprovider deploy
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5.2" data-path="doc/administering_onedata/onedatify_deploy_with_import.html">
            
                
                    <a href="../../doc/administering_onedata/onedatify_deploy_with_import.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.2.</b>
                        
                        Oneprovider deploy and expose data
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5.3" data-path="doc/administering_onedata/onezone_tutorial.html">
            
                
                    <a href="../../doc/administering_onedata/onezone_tutorial.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.3.</b>
                        
                        Onezone setup
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="Administrator manual.html">
            
            <span><b>3.6.</b> Administrator manual</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.6.1" data-path="doc/administering_onedata/oneprovider_tutorial.html">
            
                
                    <a href="../../doc/administering_onedata/oneprovider_tutorial.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.1.</b>
                        
                        Oneprovider setup
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.2" data-path="doc/administering_onedata/creating_user_accounts.html">
            
                
                    <a href="../../doc/administering_onedata/creating_user_accounts.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.2.</b>
                        
                        Creating User accounts
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.3" data-path="doc/administering_onedata/openid_saml_configuration.html">
            
                
                    <a href="../../doc/administering_onedata/openid_saml_configuration.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.3.</b>
                        
                        OpenID &amp; SAML Configuration
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.6.3.1" data-path="doc/administering_onedata/openid_saml_configuration/openid_configuration_legacy.html">
            
                
                    <a href="../../doc/administering_onedata/openid_saml_configuration/openid_configuration_legacy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.3.1.</b>
                        
                        18.02.0-rc11 or older
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.3.2" data-path="doc/administering_onedata/openid_saml_configuration/openid_saml_configuration_18_02.html">
            
                
                    <a href="../../doc/administering_onedata/openid_saml_configuration/openid_saml_configuration_18_02.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.3.2.</b>
                        
                        18.02.0-rc12 - 18.02.*
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.3.3" data-path="doc/administering_onedata/openid_saml_configuration/openid_saml_configuration_19_02.html">
            
                
                    <a href="../../doc/administering_onedata/openid_saml_configuration/openid_saml_configuration_19_02.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.3.3.</b>
                        
                        19.02.* or newer
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.3.4" data-path="doc/administering_onedata/openid_saml_configuration/google_idp_tutorial.html">
            
                
                    <a href="../../doc/administering_onedata/openid_saml_configuration/google_idp_tutorial.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.3.4.</b>
                        
                        Google IdP tutorial
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.6.4" data-path="doc/administering_onedata/provider_space_support.html">
            
                
                    <a href="../../doc/administering_onedata/provider_space_support.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.4.</b>
                        
                        Space Support
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.5" data-path="doc/administering_onedata/storage_configuration.html">
            
                
                    <a href="../../doc/administering_onedata/storage_configuration.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.5.</b>
                        
                        Storage Configuration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.6" data-path="doc/administering_onedata/storage_import.html">
            
                
                    <a href="../../doc/administering_onedata/storage_import.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.6.</b>
                        
                        Storage import
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.7" data-path="doc/administering_onedata/ceph_cluster_deployment.html">
            
                
                    <a href="../../doc/administering_onedata/ceph_cluster_deployment.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.7.</b>
                        
                        Ceph cluster deployment
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.8" data-path="doc/administering_onedata/ssl_certificate_management.html">
            
                
                    <a href="../../doc/administering_onedata/ssl_certificate_management.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.8.</b>
                        
                        SSL Certificate Management
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.9" data-path="doc/administering_onedata/firewall_setup.html">
            
                
                    <a href="../../doc/administering_onedata/firewall_setup.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.9.</b>
                        
                        Firewall Setup
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.10" data-path="doc/administering_onedata/luma.html">
            
                
                    <a href="../../doc/administering_onedata/luma.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.10.</b>
                        
                        Local User Mapping - LUMA
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.11" data-path="doc/administering_onedata/file_popularity.html">
            
                
                    <a href="../../doc/administering_onedata/file_popularity.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.11.</b>
                        
                        File-popularity
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.12" data-path="doc/administering_onedata/auto_cleaning.html">
            
                
                    <a href="../../doc/administering_onedata/auto_cleaning.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.12.</b>
                        
                        Auto-cleaning
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6.13" data-path="doc/administering_onedata/administering_onedata_from_cli.html">
            
                
                    <a href="../../doc/administering_onedata/administering_onedata_from_cli.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.13.</b>
                        
                        Admin REST API
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="doc/advanced/index.html">
            
                
                    <a href="../../doc/advanced/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Advanced topics
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="doc/advanced/cdmi.html">
            
                
                    <a href="../../doc/advanced/cdmi.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        CDMI API
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../" >Onedata Documentation</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="tokens">Tokens</h1>
<p>This documentation is valid for system versions <code>20.02.*</code> or newer. Basic 
information about legacy tokens for versions up to <code>19.02.*</code> can be found 
<a href="using_onedata_from_cli.html">here</a>.</p>
<!-- toc -->
<ul>
<li><a href="#basics">Basics</a></li>
<li><a href="#access-tokens">Access tokens</a></li>
<li><a href="#identity-tokens">Identity tokens</a></li>
<li><a href="#invite-tokens">Invite tokens</a></li>
<li><a href="#named-and-temporary-tokens">Named and temporary tokens</a></li>
<li><a href="#token-caveats">Token caveats</a><ul>
<li><a href="#caveats-compatibility">Caveats compatibility</a></li>
<li><a href="#data-access-caveats">Data access caveats</a></li>
<li><a href="#caveats-impact-on-services">Caveats impact on services</a><ul>
<li><a href="#onezone">Onezone</a></li>
<li><a href="#oneprovider">Oneprovider</a></li>
<li><a href="#onepanel">Onepanel</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#service">Service</a><ul>
<li><a href="#service-types">Service types</a></li>
<li><a href="#service-caveat-considerations">Service caveat considerations</a></li>
</ul>
</li>
<li><a href="#consumer">Consumer</a><ul>
<li><a href="#consumer-types">Consumer types</a></li>
</ul>
</li>
<li><a href="#safely-publishing-tokens">Safely publishing tokens</a></li>
<li><a href="#security-and-privacy-considerations">Security and privacy considerations</a></li>
<li><a href="#using-rest-api">Using REST API</a><ul>
<li><a href="#create-a-temporary-access-token-valid-for-1-hour">Create a temporary access token valid for 1 hour</a></li>
<li><a href="#create-a-named-access-token-for-mounting-oneclient-in-specific-oneprovider">Create a named access token for mounting Oneclient in specific Oneprovider</a></li>
<li><a href="#create-a-named-token-for-readonly-access-in-a-specific-directory">Create a named token for readonly access in a specific directory</a></li>
<li><a href="#create-a-named-token-valid-only-for-a-colleague">Create a named token valid only for a colleague</a></li>
<li><a href="#create-a-named-invite-token-for-requesting-space-support-with-4-uses">Create a named invite token for requesting space support with 4 uses</a></li>
<li><a href="#create-a-named-invite-token-for-inviting-space-members-with-certain-privileges">Create a named invite token for inviting space members with certain privileges</a></li>
<li><a href="#revoke-the-previously-created-invite-token-for-inviting-space-members">Revoke the previously created invite token for inviting space members</a></li>
</ul>
</li>
</ul>
<!-- toc stop -->
<h2 id="basics">Basics</h2>
<p>There are three types of tokens in Onedata: <a href="#access-tokens">access tokens</a>, 
<a href="#identity-tokens">identity tokens</a> and <a href="#invite-tokens">invite tokens</a>.</p>
<p>Regardless of the above-mentioned type, each token can be 
<a href="#named-and-temporary-tokens">named or temporary</a>.</p>
<p>Tokens are passed around the system in a serialized form - an alphanumeric 
string that can look like the following:
<code>MDAxNWxvY2F00aW9uIG9uZXpvbmUKMDAzYmlkZW500aWZpZXIgRHR00WTg5dH...</code></p>
<p>Onedata uses <a href="https://ai.google/research/pubs/pub41892" target="_blank">Google&apos;s macaroons</a> for underlying implementation of tokens, with
support for <a href="#token-caveats">caveats</a> - contextual confinements.</p>
<p>All tokens are created in Onezone and can only be verified by Onezone.</p>
<p>Tokens can be created using the wizard in Onezone web GUI or the <a href="#using-rest-api">REST API</a>.</p>
<p>Tokens must be kept secret - unless they are safely confined with caveats, then
passing a token to another party or publishing it is possible.</p>
<h2 id="access-tokens">Access tokens</h2>
<p>Access tokens are the basic way to authorize operations in Onedata - either in 
REST/CDMI API or when mounting Oneclient. Access tokens are a type of bearer 
authentication, which means that the party in possession of a token can use it 
to perform operations on behalf of the token subject (creator). The subject can 
be either a user or a Oneprovider service. For clarity, this documentation talks 
about user tokens, but all the aspects are symmetrical for Oneproviders.</p>
<p>Access tokens are tied to the subject that created the token. From the system&apos;s 
point of view, the token bearer is indistinguishable from the subject. Consider 
this example:</p>
<ol>
<li><p>Bob creates a token and gives it to Alice</p>
</li>
<li><p>Alice uses the token to authorize a request</p>
</li>
<li><p>The system identifies the requesting subject as Bob, authorizes and handles 
the request in this context, operating on Bob&apos;s data. It does not matter if
the requesting client (token bearer) was Alice or Bob.</p>
</li>
</ol>
<p>Access tokens carry authorization to perform operations in the system on behalf
of the subject. The authorization can be limited by caveats. If there are no
caveats, the token carries absolute power to perform any operation on behalf of 
the subject, similar to user&apos;s password.</p>
<p>Authorization in Onedata depends on the token&apos;s subject, their relations and
privileges (e.g. space membership and the privileges in the space), as well as 
token&apos;s caveats. For example, for Bob to be able to create a file in space 
<code>My experiment</code>, all below requirements need to be satisfied:</p>
<ol>
<li><p>Requesting party must present a valid token with <code>subject = Bob</code></p>
</li>
<li><p>Bob must be a member of the space <code>My experiment</code></p>
</li>
<li><p>Bob must have <code>space_write_data</code> privilege in space <code>My experiment</code></p>
</li>
<li><p>The access token must allow writing in space <code>My experiment</code> 
(or to be accurate, token caveats must not forbid writing in the space)</p>
</li>
</ol>
<p>Access tokens are a powerful tool for authority delegation, but at the same time
require caution - they must be kept secret, similarly to user passwords. However,
thanks to support for <a href="#token-caveats">caveats</a> (contextual confinements), 
tokens can be limited with fine granularity, making it safer to delegate them to 
other users or services. Nevertheless, you should never disclose your tokens to 
a party that is not trusted.</p>
<h2 id="identity-tokens">Identity tokens</h2>
<p>Identity tokens are a proof of subject&apos;s identity. Other than that, they carry 
no authorization to perform any operation in the system. Proving identity with
an identity token is required to satisfy a <a href="#consumer"><code>consumer</code> caveat</a> in 
another token. An identity token can have <a href="#token-caveats">caveats</a>, which limit
the context in which the token is accepted (e.g. shortlisting the allowed IP 
addresses from which the token can be used).</p>
<blockquote>
<p>Identity tokens must not be disclosed to other users or untrusted services,
as whoever possesses such token can impersonate the subject. They can be safely 
sent to the Onezone service. When using such token in a Oneprovider service, it 
is strongly recommended to add a short TTL for the token with a 
<a href="#token-caveats"><code>time</code> caveat</a>.</p>
</blockquote>
<h2 id="invite-tokens">Invite tokens</h2>
<p>Invite tokens in Onedata are used to create relations in the system. They can be 
consumed by anyone who possesses the token (unless the token has a <code>consumer</code> 
caveat). Typical scenario is that the inviting user (token subject) generates a 
token and passes it to somebody that they wish to invite, and the other user 
consumes the token and is added to the target entity (e.g. group or space).</p>
<p>Each token has inscribed information about the target entity of the invitation
which is chosen by the inviting user. It means that the token consumer does not 
choose where they are joining and does not need to know the target group, space
etc. - the token itself is enough to join it.</p>
<p>The Onezone Web GUI provides a comprehensive wizard for creating invite tokens
with different parameters. Below is some technical information about the invite
tokens which might be useful for <a href="#using-rest-api">REST API</a> users.</p>
<p>Invite tokens can have one of the following types:</p>
<ul>
<li><p><code>userJoinGroup</code> - can be consumed to join the target group of the 
  invitation as a user</p>
</li>
<li><p><code>groupJoinGroup</code> - can be consumed to join the target group (parent) of 
  the invitation as a group (child)</p>
</li>
<li><p><code>userJoinSpace</code> - can be consumed to join the target space of the 
  invitation as a user</p>
</li>
<li><p><code>groupJoinSpace</code> - can be consumed to join the target space of the 
  invitation as a group   </p>
</li>
<li><p><code>supportSpace</code> - can be consumed by a Oneprovider to grant support 
  (storage space) to the target space of the invitation</p>
</li>
<li><p><code>harvesterJoinSpace</code> - can be consumed to join the target space of the 
  invitation as a harvester, so that the space becomes a
  metadata source for the harvester.</p>
</li>
<li><p><code>registerOneprovider</code> - can be consumed to register a new Oneprovider and link
  it to the target user (who becomes an admin of the 
  Oneprovider service)</p>
</li>
<li><p><code>userJoinCluster</code> - can be consumed to join the target cluster of the 
  invitation as a user</p>
</li>
<li><p><code>groupJoinCluster</code> - can be consumed to join the target cluster of the 
  invitation as a group </p>
</li>
<li><p><code>userJoinHarvester</code> - can be consumed to join the target harvester of the 
  invitation as a user</p>
</li>
<li><p><code>groupJoinHarvester</code> - can be consumed to join the target harvester of the 
  invitation as a group   </p>
</li>
<li><p><code>spaceJoinHarvester</code> - can be consumed to join the target harvester of the 
  invitation as a space, so that the space becomes a
  metadata source for the harvester.</p>
</li>
</ul>
<p>Invite tokens can be created by authorized users, for example a <code>userJoinSpace</code> 
token can be created by a member of the target space that has the 
<code>space_add_user</code> privilege. The privilege is also checked when the token is
being consumed - if the creator has lost the right to invite, the token cannot
be consumed.</p>
<p>An invite token can have <a href="#token-caveats">caveats</a>, which limit the context in
which the token can be consumed.</p>
<p><a href="#named-and-temporary-tokens">Named</a> invite tokens can have additional parameters, 
which are optional:</p>
<ol>
<li><p>Carried privileges (if applicable) - defines what privileges will be granted
for the joining member upon token consumption. If not specified, default 
member privileges will be granted.</p>
</li>
<li><p>Usage limit - defines how many times the token can be used. If not specified,
there is no limit.</p>
</li>
</ol>
<h2 id="named-and-temporary-tokens">Named and temporary tokens</h2>
<p>Tokens in Onedata can be temporary or named, regardless of the type (access 
or invite). Temporary tokens are short lived and not persisted, while named 
tokens are linked to user&apos;s account and retrievable. All differences are shown 
in below table.</p>
<table>
<thead>
<tr>
<th>Temporary tokens</th>
<th>Named tokens</th>
</tr>
</thead>
<tbody>
<tr>
<td>no identification in the system</td>
<td>must have a unique name</td>
</tr>
<tr>
<td>not persisted</td>
<td>persisted</td>
</tr>
<tr>
<td>cannot be retrieved <br> <em>you must store the token upon creation</em></td>
<td>linked to subject&apos;s account</td>
</tr>
<tr>
<td>shared secret <br> <em>the secret can be regenerated, in this case all subject&apos;s temporary tokens become invalid</em></td>
<td>individual secret</td>
</tr>
<tr>
<td>cannot be deleted individually <br> <em>see shared secret above</em></td>
<td>can be deleted <br> <em>(the token immediately becomes invalid</em></td>
</tr>
<tr>
<td>non-revocable individually <br> <em>see shared secret above</em></td>
<td>revocable <br> <em>revocation can be undone at will</em></td>
</tr>
<tr>
<td>must have limited lifespan <br> <em>max permitted lifespan is configurable by the Onezone admin</em></td>
<td>can have infinite lifespan</td>
</tr>
<tr>
<td>no accounting, cannot be listed</td>
<td>can be listed in <a href="#using-rest-api">REST API</a> or viewed in web GUI</td>
</tr>
<tr>
<td>useful for automated software / middleware / scripting</td>
<td>require more management but ensure full control</td>
</tr>
</tbody>
</table>
<h2 id="token-caveats">Token caveats</h2>
<p>Each token can have any number of caveats (including none). Caveats are a 
fundamental concept of <a href="https://ai.google/research/pubs/pub41892" target="_blank">Google&apos;s macaroons</a> (which are used for token 
implementation in Onedata). Caveats are contextual confinements - they limit the
context in which a token is valid. They are inscribed in the token itself,
which enables powerful delegation features. Thanks to cryptographic signatures,
caveats cannot be removed from a token. However, they can be added to any token
by any party that possesses the token. Such operation further limits the token,
making it carry less power that the original one. The limited token can be
safely passed to another party, which won&apos;t be able to overcome the limitations
without knowing the original token. Consider this example:</p>
<ol>
<li><p>Bob creates a named token <code>Alpha</code> for accessing his data, but only in the 
 space <code>My experiment</code> - using the <code>data.path</code> caveat.</p>
</li>
<li><p>Bob confines the token <code>Alpha</code> - adds the <code>data.readonly</code> caveat - and 
 obtains token <code>Alpha*</code> with different signature.</p>
</li>
<li><p>Bob passes the token <code>Alpha*</code> to Alice. Alice is able to read the space 
 <code>My experiment</code>, but cannot modify any files. The space is accessed on 
 behalf of Bob - from the system&apos;s point of view, whoever bears the token is
 recognized as Bob. Cryptography ensures that it is computationally 
 implausible to infer token <code>Alpha</code> knowing only <code>Alpha*</code>. If Bob wishes to 
 publish his experiment data online, he can safely make the token <code>Alpha*</code> 
 public (see <a href="#safely-publishing-tokens">safely publishing tokens</a>) - nobody 
 will be able to use it in other way than to read the <code>My experiment</code> data. 
 Bob can temporarily revoke or completely delete the token <code>Alpha</code> at any 
 time, which will immediately disable the original token <code>Alpha</code> and all
 tokens derived from it - including the published <code>Alpha*</code> token. </p>
</li>
<li><p>In the meantime, Bob still uses the original token <code>Alpha</code> to write data in 
 the <code>My experiment</code> space, which becomes immediately visible for the users
 that have the <code>Alpha*</code> token.</p>
</li>
</ol>
<p>The Onezone Web GUI offers a convenient wizard for adding caveats to tokens.
Further, you will find technical details and considerations about token caveats.</p>
<p>Below is the list of all recognized caveats in Onedata. Provided examples of 
caveats are in JSON format, recognized by the <a href="#using-rest-api">REST API</a>
(consult for more information about allowed values and usage). </p>
<ul>
<li><p><code>time</code> - limits the validity of the token to a certain point in time, 
  specified as an absolute timestamp in seconds (UNIX Epoch time). If no such 
  caveat is included in a token, it is valid infinitely. Note, however, that 
  temporary tokens <strong>require</strong> a time caveat, in contrary to named tokens. </p>
<pre><code class="lang-json">  {
    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;time&quot;</span>,
    <span class="hljs-string">&quot;validUntil&quot;</span>: <span class="hljs-number">1571147494</span>
  }
</code></pre>
</li>
<li><p><code>ip</code> - limits the allowed client IPs to a certain whitelist. Supports IP 
  masks. If no such caveat is included in a token, it can be used from any IP.</p>
<pre><code class="lang-json">  {
      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;ip&quot;</span>,
      <span class="hljs-string">&quot;whitelist&quot;</span>: [
          <span class="hljs-string">&quot;189.34.15.0/24&quot;</span>,
          <span class="hljs-string">&quot;127.0.0.0/8&quot;</span>,
          <span class="hljs-string">&quot;167.73.12.17&quot;</span>
      ]
  }
</code></pre>
<blockquote>
<p>NOTE: when adding <code>ip</code> caveats, keep in mind that if your requests need to
  be proxied to another Oneprovider, the IP of the Oneprovider that received
  the original request must also be whitelisted (as it is perceived as the
  new request&apos;s client). Proxying happens when the Oneprovider that received 
  your request does not support the concerned space.</p>
</blockquote>
</li>
<li><p><code>asn</code> - limits the ASNs (Autonomous System Number) from which the token can be 
  utilized. The client&apos;s ASN is resolved based on client&apos;s IP and MaxMind&apos;s 
  GeoLite database. If no such caveat is included in a token, it can be used 
  from any ASN.</p>
<pre><code class="lang-json">  {
      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;asn&quot;</span>,
      <span class="hljs-string">&quot;whitelist&quot;</span>: [
          <span class="hljs-number">631</span>, <span class="hljs-number">632</span>, <span class="hljs-number">1671</span>
      ]
  }
</code></pre>
<blockquote>
<p>NOTE: as the client ASN detection depends on client&apos;s IP, this caveat 
  has the same considerations as the <code>ip</code> caveat when requests are proxied.</p>
</blockquote>
</li>
<li><p><code>geo.country</code> - limits the countries from which the token can be utilized. 
  Supports whitelists and blacklist. The client&apos;s country is resolved based on
  client&apos;s IP and MaxMind&apos;s GeoLite database. If no such caveat is included in 
  a token, it can be used from any country.</p>
<pre><code class="lang-json">  {
      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;geo.country&quot;</span>,
      <span class="hljs-string">&quot;filter&quot;</span>: <span class="hljs-string">&quot;blacklist&quot;</span>,
      <span class="hljs-string">&quot;list&quot;</span>: [
        <span class="hljs-string">&quot;PL&quot;</span>, <span class="hljs-string">&quot;UK&quot;</span>, <span class="hljs-string">&quot;DE&quot;</span>, <span class="hljs-string">&quot;NL&quot;</span>
      ]
  }
</code></pre>
<blockquote>
<p>NOTE: as the client country detection depends on client&apos;s IP, this caveat
  has the same considerations as the <code>ip</code> caveat when requests are proxied.</p>
</blockquote>
</li>
<li><p><code>geo.region</code> - limits the geographical regions from which the token can be 
  utilized. The available values are the 7 continents (<code>&quot;Oceania&quot;</code> covers 
  Australia and the pacific islands) or the <code>&quot;EU&quot;</code> meta region, which matches 
  member countries of the European Union. The client&apos;s region is resolved 
  based on client&apos;s IP and MaxMind&apos;s GeoLite database. If no such caveat is 
  included in a token, it can be used from any region.</p>
<pre><code class="lang-json">  {
      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;geo.region&quot;</span>,
      <span class="hljs-string">&quot;filter&quot;</span>: <span class="hljs-string">&quot;whitelist&quot;</span>,
      <span class="hljs-string">&quot;list&quot;</span>: [
          <span class="hljs-string">&quot;Africa&quot;</span>,
          <span class="hljs-string">&quot;Antarctica&quot;</span>,
          <span class="hljs-string">&quot;Asia&quot;</span>,
          <span class="hljs-string">&quot;EU&quot;</span>,
          <span class="hljs-string">&quot;Europe&quot;</span>,
          <span class="hljs-string">&quot;NorthAmerica&quot;</span>,
          <span class="hljs-string">&quot;Oceania&quot;</span>,
          <span class="hljs-string">&quot;SouthAmerica&quot;</span>
      ]
  }
</code></pre>
<blockquote>
<p>NOTE: as the client region detection depends on client&apos;s IP, this caveat
  has the same considerations as the <code>ip</code> caveat when requests are proxied.</p>
</blockquote>
</li>
<li><p><code>service</code> - limits the <a href="#service">services</a> that can process the token.
  Imposes implicit <a href="#service-caveat-considerations">API limitations</a>.
  If the caveat is present, the service must prove its identity by sending 
  its identity token in the <code>x-onedata-service-token</code> header. The services 
  must be encoded using the proper <a href="#service-types">service format</a>.
  If no such caveat is included in a token, it can be used in any service.</p>
<pre><code class="lang-json">  {
      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;service&quot;</span>,
      <span class="hljs-string">&quot;whitelist&quot;</span>: [
          <span class="hljs-string">&quot;ozw-onezone&quot;</span>,
          <span class="hljs-string">&quot;ozp-onezone&quot;</span>,
          <span class="hljs-string">&quot;opw-*&quot;</span>,
          <span class="hljs-string">&quot;opp-01c4455bef059353c9dfb35ba93a24f3&quot;</span>
      ]
  }
</code></pre>
<blockquote>
<p>NOTE: when adding <code>service</code> caveats, keep in mind that if your requests 
  need to be proxied to another Oneprovider, it must also be whitelisted. 
  Proxying happens when the Oneprovider that received your request does not 
  support the concerned space.</p>
</blockquote>
</li>
<li><p><code>consumer</code> - limits the <a href="#consumer">consumers</a> that can utilize the token.
  If the caveat is present, the consumer must prove their identity by sending 
  their identity token in the <code>x-onedata-consumer-token</code> header. The consumers 
  must be encoded using the proper <a href="#consumer-types">consumer format</a>. 
  If no such caveat is included in a token, it can be used by any bearer.</p>
<pre><code class="lang-json">  {
      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;consumer&quot;</span>,
      <span class="hljs-string">&quot;whitelist&quot;</span>: [
          <span class="hljs-string">&quot;usr-d4f5876dbe7f1e7e8a511de6dd31144c&quot;</span>,
          <span class="hljs-string">&quot;grp-0921135ee61fe53a3df449365228e9b4&quot;</span>,
          <span class="hljs-string">&quot;prv-*&quot;</span>
      ]
  }
</code></pre>
</li>
<li><p><code>interface</code> - limits the available interfaces on which the token can be used 
  to a certain one - <code>rest</code>, <code>oneclient</code> or <code>graphsync</code>. If the <code>oneclient</code> 
  interface is specified, this caveat is treated as a
  <a href="#data-access-caveats">data access caveat</a>. The <code>graphsync</code> interface is
  used internally for communication between services and does not make sense
  in tokens created by users. If no such caveat is included in a token, it can
  be used on all interfaces.</p>
<pre><code class="lang-json">  {
      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;interface&quot;</span>,
      <span class="hljs-string">&quot;interface&quot;</span>: <span class="hljs-string">&quot;rest&quot;</span>
  }
</code></pre>
</li>
<li><p><code>api</code> - limits the API operations that can be performed with the token. The 
  operations are whitelisted using the Onedata API matchspec format, which 
  includes the service identifier, operation type (CRUD) and resource 
  identifier. If no such caveat is included in a token, it can be used for all
  API calls.</p>
<pre><code class="lang-json">  {
      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;api&quot;</span>,
      <span class="hljs-string">&quot;whitelist&quot;</span>: [
          <span class="hljs-string">&quot;ozw/all/user.*.*:*&quot;</span>,
          <span class="hljs-string">&quot;all/get/space.*.*:*&quot;</span>
      ]
  }
</code></pre>
</li>
<li><p><code>data.readonly</code> - allows only read access to user files. This is a 
  <a href="#data-access-caveats">data access caveat</a>. If no such caveat is included in 
  a token, it can be used for both reading and writing data.</p>
<pre><code class="lang-json">  {
    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;data.readonly&quot;</span>
  }
</code></pre>
</li>
<li><p><code>data.path</code> - limits the paths in which data can be accessed with the token.
  The paths must be canonical - starting with a slash + space id, and without 
  a trailing slash - and must be base64 encoded. If a directory path is given, 
  the token allows to access all nested files and directories starting from 
  the specified directory. This is a <a href="#data-access-caveats">data access caveat</a>. 
  If no such caveat is included in a token, it can be used for accessing all
  user files.</p>
<pre><code class="lang-json">  {
      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;data.path&quot;</span>,
      <span class="hljs-string">&quot;whitelist&quot;</span>: [
          <span class="hljs-string">&quot;L2QxYjM4OGY3Yzc=&quot;</span>,
          <span class="hljs-string">&quot;L2QxYjM4OGY3YzcvZGlyL2ZpbGUudHh0&quot;</span>
      ]
  }
</code></pre>
<pre><code>  &quot;L2QxYjM4OGY3Yzc=&quot;                  ==  base64(&quot;/d1b388f7c7&quot;)
  &quot;L2QxYjM4OGY3YzcvZGlyL2ZpbGUudHh0&quot;  ==  base64(&quot;/d1b388f7c7/dir/file.txt&quot;)
</code></pre></li>
<li><p><code>data.objectid</code> - limits the object ids in which data can be accessed with the 
  token. The object ids comply with the CDMI format and can be used in the
  Oneprovider&apos;s REST and CDMI APIs. If a directory object id is given, the 
  token allows to access all nested files and directories starting from the 
  specified directory. This is a <a href="#data-access-caveats">data access caveat</a>.
  If no such caveat is included in a token, it can be used for accessing all
  user files.</p>
<pre><code class="lang-json">  {
      <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;data.objectid&quot;</span>,
      <span class="hljs-string">&quot;whitelist&quot;</span>: [
          <span class="hljs-string">&quot;000000000055D4E4836803640004677569646D000000167&quot;</span>,
          <span class="hljs-string">&quot;39592D594E736C676D0000002B43592D347247454C535F6&quot;</span>
      ]
  }
</code></pre>
<blockquote>
<p>NOTE: <code>data.objectid</code> caveats are computationally heavier than <code>data.path</code>
  caveats - you should use the latter whenever possible for performance 
  reasons. Nevertheless, <code>data.objectid</code> have the advantage that they remain
  valid even if the target file is moved / renamed (given that the file id 
  does not change in the process) - contrary to <code>data.path</code> caveats.</p>
</blockquote>
</li>
</ul>
<h3 id="caveats-compatibility">Caveats compatibility</h3>
<p>Below table shows compatibility of caveats with access, identity and invite 
tokens. Note that adding an unrecognized or incompatible caveat causes the token 
to always fail verification (renders it unusable in practice).</p>
<ul>
<li><span style="color:#480"> allowed </span> - the caveat is recognized and will
  be checked against the request context</li>
<li><span style="color:red"> rejected </span> - presence of this caveat will cause
  immediate token verification failure</li>
</ul>
<table>
<thead>
<tr>
<th>Caveat</th>
<th style="text-align:center">Access tokens</th>
<th style="text-align:center">Identity tokens</th>
<th style="text-align:center">Invite tokens</th>
</tr>
</thead>
<tbody>
<tr>
<td>time</td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
</tr>
<tr>
<td>ip</td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
</tr>
<tr>
<td>asn</td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
</tr>
<tr>
<td>geo.country</td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
</tr>
<tr>
<td>geo.region</td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
</tr>
<tr>
<td>service</td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
<td style="text-align:center"><span style="color:red"> rejected </span></td>
<td style="text-align:center"><span style="color:red"> rejected </span></td>
</tr>
<tr>
<td>consumer</td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
</tr>
<tr>
<td>interface</td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
<td style="text-align:center"><span style="color:red"> rejected </span></td>
</tr>
<tr>
<td>api</td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
<td style="text-align:center"><span style="color:red"> rejected </span></td>
<td style="text-align:center"><span style="color:red"> rejected </span></td>
</tr>
<tr>
<td>data.readonly</td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
<td style="text-align:center"><span style="color:red"> rejected </span></td>
<td style="text-align:center"><span style="color:red"> rejected </span></td>
</tr>
<tr>
<td>data.path</td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
<td style="text-align:center"><span style="color:red"> rejected </span></td>
<td style="text-align:center"><span style="color:red"> rejected </span></td>
</tr>
<tr>
<td>data.objectid</td>
<td style="text-align:center"><span style="color:#480"> allowed </span></td>
<td style="text-align:center"><span style="color:red"> rejected </span></td>
<td style="text-align:center"><span style="color:red"> rejected </span></td>
</tr>
</tbody>
</table>
<blockquote>
<p>Identity tokens do not allow <code>service</code>, <code>api</code> or data access caveats as they
are only relevant when requesting an API operation or in data access context.</p>
<p>Invite tokens are specialized for one operation and always used in the Onezone
service, hence they allow only suitable caveats.</p>
</blockquote>
<h3 id="data-access-caveats">Data access caveats</h3>
<p><em>Data access caveats</em> are a special kind of caveat that carry additional, implicit
restrictions. Existence of <strong>any data access caveat</strong> in a token determines that 
the token is intended exclusively for accessing user files and causes all other 
APIs to be disallowed or limited to the minimum required to handle data access 
requests. Such tokens can only be used in the Oneprovider service for REST/CDMI
operations on files or mounting a Oneclient.</p>
<p>The list of <em>data access caveats</em>:</p>
<ul>
<li><code>interface</code>, but only if equal to <code>oneclient</code></li>
<li><code>data.readonly</code></li>
<li><code>data.path</code></li>
<li><code>data.objectid</code></li>
</ul>
<p>The idea behind <em>data access caveats</em> is to impose high level of security when
token intended for data access is delegated. For example, it is possible to 
create a token with <code>data.path</code> and <code>data.readonly</code> caveats, limiting the rights 
to readonly access in a single directory. Such token can be published online 
without the risk of malicious utilization 
(see <a href="#safely-publishing-tokens">safely publishing tokens</a>) - the token forbids 
any API operations and can be used solely to read the specified directory.</p>
<blockquote>
<p>These restrictions improve security, but the downside is that it is not 
possible to grant somebody restricted access to files and the system API at the 
same time with one token - two different tokens must be created.</p>
</blockquote>
<p>The alternative would be to make no implicit restrictions and expect users to 
consciously limit the token with <code>api</code> caveats whenever they wish to safely 
publish it. That, however, was deemed too obscure, unintuitive and risky, as it 
would require a deep knowledge of the underlying mechanisms.</p>
<h3 id="caveats-impact-on-services">Caveats impact on services</h3>
<p>Each caveat can have a big impact on the token usability in the system, 
depending on the type. Above-mentioned <em>data access caveats</em> are a good
example - their presence in the token greatly restricts the available services. 
Beside that, there are some other considerations of token caveat usage, 
summarized in the below tables.</p>
<ul>
<li><span style="color:#480"> allowed </span> - the caveat is recognized and will
  be checked against the request context</li>
<li><span style="color:red"> rejected </span> - presence of this caveat will cause
  immediate token verification failure</li>
<li><span style="color:#aa0"> restricted </span> - the caveat is allowed only in 
  certain circumstances - see footnotes for details</li>
</ul>
<h4 id="onezone">Onezone</h4>
<table>
<thead>
<tr>
<th>Interface</th>
<th style="text-align:center">REST</th>
<th style="text-align:center">GraphSync<sup><a href="#fn_1" id="reffn_1">1</a></sup> (GUI)</th>
<th style="text-align:center">GraphSync<sup><a href="#fn_1" id="reffn_1">1</a></sup> (Oneprovider)</th>
</tr>
</thead>
<tbody>
<tr>
<td>time</td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
<td style="text-align:center"><span style="color:#480"> allowed       </span></td>
<td style="text-align:center"><span style="color:#480"> allowed        </span></td>
</tr>
<tr>
<td>ip</td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
<td style="text-align:center"><span style="color:#480"> allowed       </span></td>
<td style="text-align:center"><span style="color:#480"> allowed        </span></td>
</tr>
<tr>
<td>asn</td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
<td style="text-align:center"><span style="color:#480"> allowed       </span></td>
<td style="text-align:center"><span style="color:#480"> allowed        </span></td>
</tr>
<tr>
<td>geo.country</td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
<td style="text-align:center"><span style="color:#480"> allowed       </span></td>
<td style="text-align:center"><span style="color:#480"> allowed        </span></td>
</tr>
<tr>
<td>geo.region</td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
<td style="text-align:center"><span style="color:#480"> allowed       </span></td>
<td style="text-align:center"><span style="color:#480"> allowed        </span></td>
</tr>
<tr>
<td>service</td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
<td style="text-align:center"><span style="color:#480"> allowed       </span></td>
<td style="text-align:center"><span style="color:#480"> allowed        </span></td>
</tr>
<tr>
<td>consumer</td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
<td style="text-align:center"><span style="color:#480"> allowed       </span></td>
<td style="text-align:center"><span style="color:#480"> allowed        </span></td>
</tr>
<tr>
<td>interface<sup><a href="#fn_2" id="reffn_2">2</a></sup></td>
<td style="text-align:center"><span style="color:#aa0"> <code>&quot;rest&quot;</code> </span></td>
<td style="text-align:center"><span style="color:#aa0"> <code>&quot;graphsync&quot;</code> </span></td>
<td style="text-align:center"><span style="color:#aa0"> restricted<sup><a href="#fn_3" id="reffn_3">3</a></sup> </span></td>
</tr>
<tr>
<td>api</td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
<td style="text-align:center"><span style="color:#480"> allowed       </span></td>
<td style="text-align:center"><span style="color:#480"> allowed        </span></td>
</tr>
<tr>
<td>data.readonly</td>
<td style="text-align:center"><span style="color:red">  rejected </span></td>
<td style="text-align:center"><span style="color:red">  rejected      </span></td>
<td style="text-align:center"><span style="color:#aa0"> restricted<sup><a href="#fn_3" id="reffn_3">3</a></sup> </span></td>
</tr>
<tr>
<td>data.path</td>
<td style="text-align:center"><span style="color:red">  rejected </span></td>
<td style="text-align:center"><span style="color:red">  rejected      </span></td>
<td style="text-align:center"><span style="color:#aa0"> restricted<sup><a href="#fn_3" id="reffn_3">3</a></sup> </span></td>
</tr>
<tr>
<td>data.objectid</td>
<td style="text-align:center"><span style="color:red">  rejected </span></td>
<td style="text-align:center"><span style="color:red">  rejected      </span></td>
<td style="text-align:center"><span style="color:#aa0"> restricted<sup><a href="#fn_3" id="reffn_3">3</a></sup> </span></td>
</tr>
</tbody>
</table>
<p><sup><a href="#fn_1" id="reffn_1">1</a></sup>: 
The GraphSync interface is used internally for communication between services 
and is not used directly by users, but is included in the table for reference.
The information in the table is the same for the GraphSync interfaces of
Oneprovider and Onepanel and omitted in tables that follow.</p>
<p><sup><a href="#fn_2" id="reffn_2">2</a></sup>: 
The interface caveat must match the interface on which the request has been 
made, as shown in the table. There is one exception - the Oneprovider GraphSync 
channel, where Onezone accepts all types of tokens that were delegated by users 
to Oneproviders, but the included caveats can impose further restrictions 
(e.g. when interface is equal to <code>&quot;oneclient&quot;</code>).</p>
<p><sup><a href="#fn_3" id="reffn_3">3</a></sup>: 
Oneprovider service uses the GraphSync channel to fetch user data from Onezone. 
It uses the token that was passed to it by the user, either when they made a call
to the REST/CDMI API, mounted a Oneclient, or visited the Oneprovider GUI (which
utilizes a gui access token in the background). If the token contains any of the
<em>data access caveats</em>, Onezone will allow to fetch only the basic user info, 
necessary to handle the request, and block all other API operations. Even if the 
Oneprovider is malicious and somehow managed to trick the user into trusting it, 
it will not be able to cause any damage with such token.</p>
<h4 id="oneprovider">Oneprovider</h4>
<table>
<thead>
<tr>
<th>Interface</th>
<th style="text-align:center">Oneclient</th>
<th style="text-align:center">CDMI &amp; REST<br>(data access operations)<sup><a href="#fn_1" id="reffn_1">1</a></sup></th>
<th style="text-align:center">REST<br>(other operations)<sup><a href="#fn_2" id="reffn_2">2</a></sup></th>
</tr>
</thead>
<tbody>
<tr>
<td>time</td>
<td style="text-align:center"><span style="color:#480"> allowed       </span></td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
</tr>
<tr>
<td>ip</td>
<td style="text-align:center"><span style="color:#480"> allowed       </span></td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
</tr>
<tr>
<td>asn</td>
<td style="text-align:center"><span style="color:#480"> allowed       </span></td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
</tr>
<tr>
<td>geo.country</td>
<td style="text-align:center"><span style="color:#480"> allowed       </span></td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
</tr>
<tr>
<td>geo.region</td>
<td style="text-align:center"><span style="color:#480"> allowed       </span></td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
</tr>
<tr>
<td>service</td>
<td style="text-align:center"><span style="color:#480"> allowed       </span></td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
</tr>
<tr>
<td>consumer</td>
<td style="text-align:center"><span style="color:red">  rejected<sup><a href="#fn_3" id="reffn_3">3</a></sup> </span></td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
</tr>
<tr>
<td>interface</td>
<td style="text-align:center"><span style="color:#aa0"> <code>&quot;oneclient&quot;</code> </span></td>
<td style="text-align:center"><span style="color:#aa0"> <code>&quot;rest&quot;</code> </span></td>
<td style="text-align:center"><span style="color:#aa0"> <code>&quot;rest&quot;</code> </span></td>
</tr>
<tr>
<td>api</td>
<td style="text-align:center"><span style="color:#480"> allowed       </span></td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
</tr>
<tr>
<td>data.readonly</td>
<td style="text-align:center"><span style="color:#480"> allowed       </span></td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
<td style="text-align:center"><span style="color:red">  rejected </span></td>
</tr>
<tr>
<td>data.path</td>
<td style="text-align:center"><span style="color:#480"> allowed       </span></td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
<td style="text-align:center"><span style="color:red">  rejected </span></td>
</tr>
<tr>
<td>data.objectid</td>
<td style="text-align:center"><span style="color:#480"> allowed       </span></td>
<td style="text-align:center"><span style="color:#480"> allowed  </span></td>
<td style="text-align:center"><span style="color:red">  rejected </span></td>
</tr>
</tbody>
</table>
<p><sup><a href="#fn_1" id="reffn_1">1</a></sup>: 
Data access operations include the whole CDMI API and REST endpoints to manage
file and directory contents, metadata, permissions and ACLs. These endpoints
can be accessed with tokens that include a <em>data access caveat</em>.</p>
<p><sup><a href="#fn_2" id="reffn_2">2</a></sup>: 
Other REST operations include the API for: shares, spaces, views, 
replicas &amp; transfers, QoS, monitoring and datastore changes stream.
These endpoints are forbidden when the token includes a <em>data access caveat</em>.</p>
<p><sup><a href="#fn_3" id="reffn_3">3</a></sup>: 
Currently it is not possible to provide a consumer token when mounting Oneclient, 
which makes it impossible to verify consumer caveats on this interface.</p>
<h4 id="onepanel">Onepanel</h4>
<table>
<thead>
<tr>
<th>Interface</th>
<th style="text-align:center">REST (Onezone panel)</th>
<th style="text-align:center">REST (Oneprovider panel)</th>
</tr>
</thead>
<tbody>
<tr>
<td>time</td>
<td style="text-align:center"><span style="color:#480"> allowed     </span></td>
<td style="text-align:center"><span style="color:#480"> allowed     </span></td>
</tr>
<tr>
<td>ip</td>
<td style="text-align:center"><span style="color:#480"> allowed     </span></td>
<td style="text-align:center"><span style="color:red"> rejected<sup><a href="#fn_1" id="reffn_1">1</a></sup> </span></td>
</tr>
<tr>
<td>asn</td>
<td style="text-align:center"><span style="color:#480"> allowed     </span></td>
<td style="text-align:center"><span style="color:red"> rejected<sup><a href="#fn_1" id="reffn_1">1</a></sup> </span></td>
</tr>
<tr>
<td>geo.country</td>
<td style="text-align:center"><span style="color:#480"> allowed     </span></td>
<td style="text-align:center"><span style="color:red"> rejected<sup><a href="#fn_1" id="reffn_1">1</a></sup> </span></td>
</tr>
<tr>
<td>geo.region</td>
<td style="text-align:center"><span style="color:#480"> allowed     </span></td>
<td style="text-align:center"><span style="color:red"> rejected<sup><a href="#fn_1" id="reffn_1">1</a></sup> </span></td>
</tr>
<tr>
<td>service</td>
<td style="text-align:center"><span style="color:#480"> allowed     </span></td>
<td style="text-align:center"><span style="color:#480"> allowed     </span></td>
</tr>
<tr>
<td>consumer</td>
<td style="text-align:center"><span style="color:#480"> allowed     </span></td>
<td style="text-align:center"><span style="color:#480"> allowed     </span></td>
</tr>
<tr>
<td>interface</td>
<td style="text-align:center"><span style="color:red"> rejected<sup><a href="#fn_2" id="reffn_2">2</a></sup> </span></td>
<td style="text-align:center"><span style="color:red"> rejected<sup><a href="#fn_2" id="reffn_2">2</a></sup> </span></td>
</tr>
<tr>
<td>api</td>
<td style="text-align:center"><span style="color:#480"> allowed     </span></td>
<td style="text-align:center"><span style="color:#480"> allowed     </span></td>
</tr>
<tr>
<td>data.readonly</td>
<td style="text-align:center"><span style="color:red"> rejected     </span></td>
<td style="text-align:center"><span style="color:red"> rejected     </span></td>
</tr>
<tr>
<td>data.path</td>
<td style="text-align:center"><span style="color:red"> rejected     </span></td>
<td style="text-align:center"><span style="color:red"> rejected     </span></td>
</tr>
<tr>
<td>data.objectid</td>
<td style="text-align:center"><span style="color:red"> rejected     </span></td>
<td style="text-align:center"><span style="color:red"> rejected     </span></td>
</tr>
</tbody>
</table>
<p><sup><a href="#fn_1" id="reffn_1">1</a></sup>:
Currently, only Onezone panel supports the IP related caveats (including 
ASN, country and region, which are checked using a GEO IP database). The 
support in Oneprovider panel is under implementation. For that time, tokens 
with such caveats are immediately rejected.</p>
<p><sup><a href="#fn_2" id="reffn_2">2</a></sup>: 
Currently, the support for <code>interface</code> caveat in both Onepanels is under 
implementation. For that time, tokens with such caveats are immediately rejected.</p>
<h2 id="service">Service</h2>
<p>Service is the Onedata service that received the client&apos;s request and is 
handling their access token. For example, the Oneprovider service chosen by a 
user to mount a Oneclient or make a CDMI request. </p>
<p>It is possible to limit the allowed services using the <code>service</code> caveat. In such
case, the service that received the request must be whitelisted, otherwise the
operation will not be authorized. Behind the scenes, the service must prove its
identity by sending its identity token to Onezone.            </p>
<h3 id="service-types">Service types</h3>
<p>There are 4 service types in Onedata. Note the serialized format in the table
below if you wish to use the <a href="#using-rest-api">REST API</a> for creating tokens 
with <code>service</code> caveats - the first three letters denote the type, and the rest 
after the hyphen is the <code>id</code> of the corresponding Oneprovider or special 
<code>onezone</code> keyword for the Onezone service. </p>
<table>
<thead>
<tr>
<th>Service</th>
<th style="text-align:center">Examples (serialized format)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Onezone</td>
<td style="text-align:center"><code>ozw-onezone</code></td>
</tr>
<tr>
<td>Onezone panel (for admins)</td>
<td style="text-align:center"><code>ozp-onezone</code></td>
</tr>
<tr>
<td>Oneprovider</td>
<td style="text-align:center"><code>opw-01c4455bef059353c9dfb35ba93a24f3</code> <br> <code>opw-*</code></td>
</tr>
<tr>
<td>Oneprovider panel (for admins)</td>
<td style="text-align:center"><code>opp-01c4455bef059353c9dfb35ba93a24f3</code> <br> <code>opp-*</code></td>
</tr>
</tbody>
</table>
<blockquote>
<p>Note: the special <code>*</code> service <code>id</code> can be used to allow any service of given
type (e.g. any Oneprovider service).</p>
</blockquote>
<h3 id="service-caveat-considerations">Service caveat considerations</h3>
<p>Service caveats impose implicit API limitations depending on the whitelisted
services. It is <em>strongly recommended</em> to include a service caveat in all tokens
that are used to access services other than Onezone - this way, the service
is given limited power to perform operations on behalf of the user, restricted
to the necessary minimum. For example, a token used to mount a Oneclient should
be confined with a service caveat that whitelists just the Oneprovider service. 
Such token cannot be used in Onezone API for any (possibly malicious) operations, 
which ensures security even if the Oneprovider service is not fully trusted.</p>
<h2 id="consumer">Consumer</h2>
<p>Consumer is the token bearer that utilizes the token - performs a request with 
an access token or attempts to consume an invite token. It is possible to create
a token that will only be consumable by whitelisted subjects. Consider Bob, who
creates an access token allowing to access his space and adds a <code>consumer</code> 
caveat that limits the allowed consumers to Alice:</p>
<pre><code class="lang-json">{
    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;consumer&quot;</span>,
    <span class="hljs-string">&quot;whitelist&quot;</span>: [
        <span class="hljs-string">&quot;usr-5c9dfb35db55bef7e8a51dfb35ba93a2&quot;</span>
    ]
}
</code></pre>
<ul>
<li><code>5c9dfb35db55bef7e8a51dfb35ba93a2</code> - Alice&apos;s user <code>id</code></li>
</ul>
<p>Then, Bob passes the confined token to Alice. In such case, Alice has to prove 
her identity by adding her <a href="#identity-tokens">identity token</a> to the request:</p>
<pre><code class="lang-bash">~$ curl -H <span class="hljs-string">&quot;x-auth-token: <span class="hljs-variable">${BOBS_ACCESS_TOKEN}</span>&quot;</span> \
        -H <span class="hljs-string">&quot;x-onedata-consumer-token: <span class="hljs-variable">${ALICES_IDENTITY_TOKEN}</span>&quot;</span> \
        -X GET ...
</code></pre>
<p>Without a valid <code>x-onedata-consumer-token</code> belonging specifically to Alice, the
request will fail with unverified caveat error. </p>
<h3 id="consumer-types">Consumer types</h3>
<p>There are 3 consumer types in Onedata. Note the serialized format in the table
below if you wish to use the <a href="#using-rest-api">REST API</a> for creating tokens 
with <code>consumer</code> caveats - the first three letters denote the type, and the rest 
after the hyphen is the <code>id</code> of the corresponding user / group / Oneprovider. </p>
<table>
<thead>
<tr>
<th>Consumer</th>
<th style="text-align:center">Examples (serialized format)</th>
</tr>
</thead>
<tbody>
<tr>
<td>user</td>
<td style="text-align:center"><code>usr-d4f5876dbe7f1e7e8a511de6dd31144c</code> <br> <code>usr-*</code></td>
</tr>
<tr>
<td>group</td>
<td style="text-align:center"><code>grp-0921135ee61fe53a3df449365228e9b4</code> <br> <code>grp-*</code></td>
</tr>
<tr>
<td>Oneprovider</td>
<td style="text-align:center"><code>prv-01c4455bef059353c9dfb35ba93a24f3</code> <br> <code>prv-*</code></td>
</tr>
</tbody>
</table>
<blockquote>
<p>Note: group is a special consumer that can be put into the <code>consumer</code> caveat&apos;s 
whitelist. It will be successfully verified if the request&apos;s consumer is a user 
that belongs to the specified group.</p>
<p>Note: the special <code>*</code> consumer <code>id</code> can be used to allow any consumer of given
type (e.g. any user or any Oneprovider).</p>
</blockquote>
<h2 id="safely-publishing-tokens">Safely publishing tokens</h2>
<p>It is possible to create a token with very limited rights and safely publish it
online so anyone can use it to access user&apos;s resources. Nevertheless, it must 
always be done with great care, as the bearer of the token can perform 
operations on behalf of the issuing subject. If the published token is too open, 
anyone might be able to tinker with user&apos;s account and data.</p>
<p>When creating a token for public use, consider the following:</p>
<ul>
<li><p>Make sure to include carefully chosen <a href="#data-access-caveats">data access caveats</a> 
in the token (<code>data_readonly</code>, <code>data_path</code>, <code>data_objectid</code>). In a typical scenario, 
you may want to allow readonly access to a certain subset of your data.</p>
</li>
<li><p>In rare cases, you can use an <code>api</code> caveat to enable a very specific API 
operation that you want to be publicly available in your name. Remember that 
<code>api</code> and <em>data access caveats</em> <a href="#data-access-caveats">do not go together</a>.</p>
</li>
<li><p>It may be reasonable to use an <code>interface</code> caveat and specify the interface
on which the token will be exclusively accepted. For example, if <code>oneclient</code>
interface is specified, the token bearer will not be able to perform any API
operations via REST, which increases security.</p>
</li>
<li><p>Consider using <code>consumer</code> caveats to limit the available consumers of the 
token and <code>service</code> caveats to make the token usable only in chosen services.</p>
</li>
<li><p>Make sure to create a <code>named</code> token to be able to revoke or delete it at any 
time.</p>
</li>
</ul>
<h2 id="security-and-privacy-considerations">Security and privacy considerations</h2>
<p>Here are some technical details concerning the security and privacy when using
or delegating access tokens:</p>
<ul>
<li><p>You should always keep your tokens safe, just like you would do with your
passwords or certificates / private keys. The exceptions are 1) when passing an 
invite token to somebody you wish to invite or 2) when delegating an access 
token that has been properly limited by caveats.</p>
</li>
<li><p>It is strongly recommended to include a 
<a href="#service-caveat-considerations">service caveat</a> in all tokens that are used
outside of Onezone service.</p>
</li>
<li><p>When a Oneprovider or Oneprovider panel service receives a request along with
an access token, it is required that the token&apos;s subject user trust the service
and is entitled to use it. In case of Oneprovider, the user must be supported 
by the Oneprovider - must have access to at least one space that is supported by
the Oneprovider, which implies bidirectional trust between the user and the 
Oneprovider. To use a Oneprovider panel service, the user must be a member of
the cluster corresponding to the Oneprovider. If above conditions are not met,
authorization is declined. This is checked by Onezone when releasing user data. 
It is not possible to utilize the token in an untrusted Oneprovider, which 
protects from data exfiltration.</p>
</li>
<li><p>Tokens with <a href="#data-access-caveats">data access caveats</a> can be used only on 
Oneprovider interfaces (Oneclient / REST / CDMI). When using such token, the 
bearer is not able to learn token subject&apos;s account information or private data.
The information is processed by the Oneprovider to handle the request, but never 
disclosed to the client. As stated in previous point, the Oneprovider must be 
supporting the subject user, which implies that it is trusted.</p>
</li>
<li><p><em>Data access caveats</em> <a href="#caveats-impact-on-services">implicitly limit the available APIs</a>
to a minimum so that the token bearer cannot perform any modifications to 
subject&apos;s account or read private information.</p>
</li>
<li><p><code>data_path</code> and <code>data_objectid</code> caveats imply in which spaces the token can be
used - other spaces are completely invisible and inaccessible to the token bearer.</p>
</li>
</ul>
<h2 id="using-rest-api">Using REST API</h2>
<p>Below are some examples how the REST API can be used to manage user tokens. For
detailed documentation of all endpoints, please refer to the 
<a href="https://onedata.org/#/home/api/latest/onezone?anchor=tag/Token" target="_blank">API documentation</a>.</p>
<p>Below examples assume that the following envs are exported:</p>
<pre><code class="lang-bash">REST_API=<span class="hljs-string">&quot;https://&lt;onezone-domain&gt;/api/v3/onezone&quot;</span>
AUTH_HEADER=<span class="hljs-string">&quot;x-auth-token: &lt;your-access-token&gt;&quot;</span>
CT=<span class="hljs-string">&quot;content-type: application/json&quot;</span>
</code></pre>
<h4 id="create-a-temporary-access-token-valid-for-1-hour">Create a temporary access token valid for 1 hour</h4>
<p>Find out current time in Onezone:</p>
<pre><code class="lang-bash">curl <span class="hljs-variable">${REST_API}</span>/provider/public/get_current_time
</code></pre>
<pre><code class="lang-bash">{<span class="hljs-string">&quot;timeMillis&quot;</span>:<span class="hljs-number">1582046102940</span>}
</code></pre>
<p>Divide by 1000 to get time in seconds, add 3600 (1 hour validity) and use in
a <code>time</code> caveat:</p>
<pre><code class="lang-bash">curl -H <span class="hljs-string">&quot;<span class="hljs-variable">${AUTH_HEADER}</span>&quot;</span> -H <span class="hljs-string">&quot;<span class="hljs-variable">${CT}</span>&quot;</span> -X POST <span class="hljs-variable">${REST_API}</span>/user/tokens/temporary <span class="hljs-operator">-d</span> <span class="hljs-string">&apos;{
  &quot;type&quot;: {
    &quot;accessToken&quot;: {}
  },
  &quot;caveats&quot;: [
    {
      &quot;type&quot;: &quot;time&quot;,
      &quot;validUntil&quot;: 1582049702
    }
  ]
}&apos;</span>
</code></pre>
<pre><code class="lang-bash">{<span class="hljs-string">&quot;token&quot;</span>:<span class="hljs-string">&quot;MDAyMGxvY2F00aW9uIG96LjE1ODIwNDY1MzcudGVzdAowMDRjciAyL3Rt...&quot;</span>}
</code></pre>
<h4 id="create-a-named-access-token-for-mounting-oneclient-in-specific-oneprovider">Create a named access token for mounting Oneclient in specific Oneprovider</h4>
<p>Identify the Id of the desired Oneprovider - you can visit the web GUI and go to
the Overview tab in the Oneprovider. Assume the Id is <code>3fe8f8eafb53c7205eeffde461a50348chfaf0</code>.</p>
<pre><code class="lang-bash">curl -H <span class="hljs-string">&quot;<span class="hljs-variable">${AUTH_HEADER}</span>&quot;</span> -H <span class="hljs-string">&quot;<span class="hljs-variable">${CT}</span>&quot;</span> -X POST <span class="hljs-variable">${REST_API}</span>/user/tokens/named <span class="hljs-operator">-d</span> <span class="hljs-string">&apos;{
  &quot;name&quot;: &quot;Oneclient access token&quot;,
  &quot;type&quot;: {
    &quot;accessToken&quot;: {}
  },
  &quot;caveats&quot;: [
    {
      &quot;type&quot;: &quot;interface&quot;,
      &quot;interface&quot;: &quot;oneclient&quot;
    },
    {
      &quot;type&quot;: &quot;service&quot;,
      &quot;whitelist&quot;: [&quot;opw-3fe8f8eafb53c7205eeffde461a50348chfaf0&quot;]
    }
  ]
}&apos;</span>
</code></pre>
<pre><code class="lang-bash">{
  <span class="hljs-string">&quot;tokenId&quot;</span>:<span class="hljs-string">&quot;4c71496ba3dff0052c04c697b12fe157ch9a1f&quot;</span>,
  <span class="hljs-string">&quot;token&quot;</span>:<span class="hljs-string">&quot;MDAyMGxvY2F00aW91MzcudGVzdAowMuIGF00aW9uIG9696LjEA1OIwND...&quot;</span>
}
</code></pre>
<p>This token can be used only in the Oneprovider with specified Id and only for
mounting Oneclient.</p>
<h4 id="create-a-named-token-for-readonly-access-in-a-specific-directory">Create a named token for readonly access in a specific directory</h4>
<p>Assume that <code>39592D594E736C676D0000002B43592D347247454C535F6</code> is the fileId of 
the directory that is to be available with the token.</p>
<pre><code class="lang-bash">curl -H <span class="hljs-string">&quot;<span class="hljs-variable">${AUTH_HEADER}</span>&quot;</span> -H <span class="hljs-string">&quot;<span class="hljs-variable">${CT}</span>&quot;</span> -X POST <span class="hljs-variable">${REST_API}</span>/user/tokens/named <span class="hljs-operator">-d</span> <span class="hljs-string">&apos;{
  &quot;name&quot;: &quot;Readonly access to experiment data&quot;,
  &quot;type&quot;: {
    &quot;accessToken&quot;: {}
  },
  &quot;caveats&quot;: [
    {
      &quot;type&quot;: &quot;data.readonly&quot;
    },
    {
      &quot;type&quot;: &quot;data.objectid&quot;,
      &quot;whitelist&quot;: [
        &quot;39592D594E736C676D0000002B43592D347247454C535F6&quot;
      ]
    }
  ]
}&apos;</span>
</code></pre>
<pre><code class="lang-bash">{
  <span class="hljs-string">&quot;tokenId&quot;</span>:<span class="hljs-string">&quot;0052c06ba3d7ch9a1ff2fe154c697b14c7149f&quot;</span>,
  <span class="hljs-string">&quot;token&quot;</span>:<span class="hljs-string">&quot;MDAyMGxvY2F00aW91MzcudGVzdAowMuIGF00aW9uIG9696LjEA1OIwND...&quot;</span>
}
</code></pre>
<p>Such token can be used only for readonly access to files in the specified 
directory (and its subdirectories).</p>
<h4 id="create-a-named-token-valid-only-for-a-colleague">Create a named token valid only for a colleague</h4>
<p>Please refer to the scenario <a href="#consumer">described before</a>. Assume that Bob 
wishes to create a token for Alice (user Id <code>461698917aa4c176fd86a111b6e7231ca998f1</code>) 
that would allow data access in whole space <code>e8df04bb7a8f9a644a773daf24fe631bchd5c2</code>.
Note: </p>
<pre><code class="lang-bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;/e8df04bb7a8f9a644a773daf24fe631bchd5c2&quot;</span> | base64
</code></pre>
<pre><code class="lang-bash">L2U4ZGYwNGJiN2E4ZjlhNjQ0YTc3M2RhZjI0ZmU2MzFiY2hkNWMyCg==
</code></pre>
<p>Bob&apos;s token (note <code>${BOBS_AUTH_HDR}</code>):</p>
<pre><code class="lang-bash">curl -H <span class="hljs-string">&quot;<span class="hljs-variable">${BOBS_AUTH_HDR}</span>&quot;</span> -H <span class="hljs-string">&quot;<span class="hljs-variable">${CT}</span>&quot;</span> -X POST <span class="hljs-variable">${REST_API}</span>/user/tokens/named <span class="hljs-operator">-d</span> <span class="hljs-string">&apos;{
  &quot;name&quot;: &quot;Access token for Alice&quot;,
  &quot;type&quot;: {
    &quot;accessToken&quot;: {}
  },
  &quot;caveats&quot;: [
    {
      &quot;type&quot;: &quot;consumer&quot;,
      &quot;whitelist&quot;: [&quot;usr-461698917aa4c176fd86a111b6e7231ca998f1&quot;]
    },
    {
      &quot;type&quot;: &quot;data.path&quot;,
      &quot;whitelist&quot;: [
        &quot;L2U4ZGYwNGJiN2E4ZjlhNjQ0YTc3M2RhZjI0ZmU2MzFiY2hkNWMyCg==&quot;
      ]
    }
  ]
}&apos;</span>
</code></pre>
<pre><code class="lang-bash">{
  <span class="hljs-string">&quot;tokenId&quot;</span>:<span class="hljs-string">&quot;61ff25052c04c7ba3d7ch94c697b10afe1149f&quot;</span>,
  <span class="hljs-string">&quot;token&quot;</span>:<span class="hljs-string">&quot;MDAyMGxvY2F00aW91MzcudGVzdAowMuIGF00aW9uIG9696LjEA1OIwND...&quot;</span>
}
<span class="hljs-comment"># BOBS_ACCESS_TOKEN</span>
</code></pre>
<p>Alice needs to create an identity token to be able to use Bob&apos;s token (note <code>${ALICES_AUTH_HDR}</code>):</p>
<pre><code class="lang-bash">curl -H <span class="hljs-string">&quot;<span class="hljs-variable">${ALICES_AUTH_HDR}</span>&quot;</span> -H <span class="hljs-string">&quot;<span class="hljs-variable">${CT}</span>&quot;</span> -X POST <span class="hljs-variable">${REST_API}</span>/user/tokens/temporary <span class="hljs-operator">-d</span> <span class="hljs-string">&apos;{
  &quot;type&quot;: {
    &quot;identityToken&quot;: {}
  },
  &quot;caveats&quot;: [
    {
      &quot;type&quot;: &quot;time&quot;,
      &quot;validUntil&quot;: 1582049702
    }
  ]
}&apos;</span>
</code></pre>
<pre><code class="lang-bash">{<span class="hljs-string">&quot;token&quot;</span>:<span class="hljs-string">&quot;MDAyMGxvY2F00aW9uIG96LjE1ODIwNDY1MzcudGVzdAowMDRjciAyL3Rt...&quot;</span>}
<span class="hljs-comment"># ALICES_IDENTITY_TOKEN</span>
</code></pre>
<p>Now, Alice can use the tokens like below for accessing the data in the space:</p>
<pre><code class="lang-bash">~$ curl -H <span class="hljs-string">&quot;x-auth-token: <span class="hljs-variable">${BOBS_ACCESS_TOKEN}</span>&quot;</span> \
        -H <span class="hljs-string">&quot;x-onedata-consumer-token: <span class="hljs-variable">${ALICES_IDENTITY_TOKEN}</span>&quot;</span> \
        -X GET ...
</code></pre>
<h4 id="create-a-named-invite-token-for-requesting-space-support-with-4-uses">Create a named invite token for requesting space support with 4 uses</h4>
<p>Identify the Id of the desired space - you can visit the web GUI and go to
the Overview tab in the space. Assume the Id is <code>e8df04bb7a8f9a644a773daf24fe631bchd5c2</code>.</p>
<pre><code class="lang-bash">curl -H <span class="hljs-string">&quot;<span class="hljs-variable">${AUTH_HEADER}</span>&quot;</span> -H <span class="hljs-string">&quot;<span class="hljs-variable">${CT}</span>&quot;</span> -X POST <span class="hljs-variable">${REST_API}</span>/user/tokens/named <span class="hljs-operator">-d</span> <span class="hljs-string">&apos;{
  &quot;name&quot;: &quot;Support token for My Experiment&quot;,
  &quot;type&quot;: {
    &quot;inviteToken&quot;: {
      &quot;inviteType&quot;: &quot;supportSpace&quot;,
      &quot;spaceId&quot;: &quot;e8df04bb7a8f9a644a773daf24fe631bchd5c2&quot;
    }
  },
  &quot;usageLimit&quot;: 4
}&apos;</span>
</code></pre>
<pre><code class="lang-bash">{
  <span class="hljs-string">&quot;tokenId&quot;</span>:<span class="hljs-string">&quot;28a45b0ce12fefe8e098e9d8c238d74fch4f69&quot;</span>,
  <span class="hljs-string">&quot;token&quot;</span>:<span class="hljs-string">&quot;MDAyMGxvY2F00aW91MzcudGVzdAowMuIGF00aW9uIG9696LjEA1OIwND...&quot;</span>
}
</code></pre>
<p>The token can be used 4 times (only successful attempts count). You can pass the
token to four different Oneproviders and ask for support.</p>
<h4 id="create-a-named-invite-token-for-inviting-space-members-with-certain-privileges">Create a named invite token for inviting space members with certain privileges</h4>
<p>Identify the Id of the desired space - you can visit the web GUI and go to
the Overview tab in the space. Assume the Id is <code>e8df04bb7a8f9a644a773daf24fe631bchd5c2</code>.</p>
<pre><code class="lang-bash">curl -H <span class="hljs-string">&quot;<span class="hljs-variable">${AUTH_HEADER}</span>&quot;</span> -H <span class="hljs-string">&quot;<span class="hljs-variable">${CT}</span>&quot;</span> -X POST <span class="hljs-variable">${REST_API}</span>/user/tokens/named <span class="hljs-operator">-d</span> <span class="hljs-string">&apos;{
  &quot;name&quot;: &quot;User invite for My Experiment&quot;,
  &quot;type&quot;: {
    &quot;inviteToken&quot;: {
      &quot;inviteType&quot;: &quot;userJoinSpace&quot;,
      &quot;spaceId&quot;: &quot;e8df04bb7a8f9a644a773daf24fe631bchd5c2&quot;
    }
  },
  &quot;privileges&quot;: [&quot;space_view&quot;, &quot;space_read_data&quot;, &quot;space_write_data&quot;]
}&apos;</span>
</code></pre>
<pre><code class="lang-bash">{
  <span class="hljs-string">&quot;tokenId&quot;</span>:<span class="hljs-string">&quot;ce3cec620a003576b279ddd533777ec1ch34dd&quot;</span>,
  <span class="hljs-string">&quot;token&quot;</span>:<span class="hljs-string">&quot;MDAyMGxvY2F00aW9uIG96LjE1ODIwNDY...&quot;</span>
}
</code></pre>
<p>Whoever consumes the token will join the space with privileges: 
<code>[&quot;space_view&quot;, &quot;space_read_data&quot;, &quot;space_write_data&quot;]</code>. The token has no usage
limit.</p>
<h4 id="revoke-the-previously-created-invite-token-for-inviting-space-members">Revoke the previously created invite token for inviting space members</h4>
<p>Named token create operation returns the <code>tokenId</code>, which can be used to refer
to the named token. Note the Id returned in the previous example. The token can
be revoked like this:</p>
<pre><code class="lang-bash">curl -H <span class="hljs-string">&quot;<span class="hljs-variable">${AUTH_HEADER}</span>&quot;</span> -H <span class="hljs-string">&quot;<span class="hljs-variable">${CT}</span>&quot;</span> -X PATCH \
<span class="hljs-variable">${REST_API}</span>/tokens/named/ce3cec620a003576b279ddd533777ec1ch34dd <span class="hljs-operator">-d</span> <span class="hljs-string">&apos;{
  &quot;revoked&quot;: true
}&apos;</span>
</code></pre>
<p>From now on, the invite token will not work. Revocation can be toggled at will:</p>
<pre><code class="lang-bash">curl -H <span class="hljs-string">&quot;<span class="hljs-variable">${AUTH_HEADER}</span>&quot;</span> -H <span class="hljs-string">&quot;<span class="hljs-variable">${CT}</span>&quot;</span> -X PATCH \
<span class="hljs-variable">${REST_API}</span>/tokens/named/ce3cec620a003576b279ddd533777ec1ch34dd <span class="hljs-operator">-d</span> <span class="hljs-string">&apos;{
  &quot;revoked&quot;: false
}&apos;</span>
</code></pre>
<p>The token can be used again.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../../doc/using_onedata/views.html" class="navigation navigation-prev " aria-label="Previous page: Views"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../../doc/using_onedata/oneclient.html" class="navigation navigation-next " aria-label="Next page: Oneclient CLI"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../../gitbook/app.js"></script>

    
    <script src="../../gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-onedata-theme/nanoscroller.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-onedata-theme/onedata.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-onedata-theme/w3data.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-toggle-chapters/toggle.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-responsive-iframes/plugin.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-ga/plugin.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"image-captions":{"caption":"","variable_name":"_pictures"},"ga":{"token":"UA-63301911-1","configuration":"auto"},"favicon":"doc/img/onedata.ico","search":{"maxIndexSize":1000000},"onedata-theme":{},"youtube":{},"toggle-chapters":{},"toc":{},"include":{},"responsive-iframes":{},"custom-favicon":{},"styles-sass":{},"include-html":{},"highlight":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        <!-- body:end -->
<!-- body:end -->
    </body>
    <!-- End of book Onedata Documentation -->
<!-- End of book Onedata Documentation -->
</html>
